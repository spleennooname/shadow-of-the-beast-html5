import{C as t,B as e,g as s,b as i,m as n,a as r}from"./pixi-container--XA1H1gw.js";import{w as a,k as o,n as h,i as l,e as c,E as d,l as u}from"./vendor-Cffik5UH.js";import{V as p,i as f,C as m,j as g,A as _,k as y,e as v,l as x,m as b,h as A,n as w,G as T,B as E,b as P,c as S,d as M,S as k,o as C,a as B,p as I,f as O,T as F,R,q as L,r as D,U}from"./pixi-renderer-DLoYYMz9.js";import{l as z,a as W,b as $,t as G,c as j}from"./pixi-textures-Cq7m2Rp-.js";import{F as N,M as H}from"./pixi-core-filters-BDggq3H4.js";import{S as V,B as X}from"./pixi-sprites-NGNZT2X3.js";import{G as Y,t as K,a as q,F as Q,b as Z,c as J,d as tt}from"./pixi-graphics-q8yFmetg.js";const et={},st=function(t,e,s){let i=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const t=document.querySelector("meta[property=csp-nonce]"),s=t?.nonce||t?.getAttribute("nonce");i=Promise.allSettled(e.map(t=>{if((t=function(t){return"/"+t}(t))in et)return;et[t]=!0;const e=t.endsWith(".css"),i=e?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${t}"]${i}`))return;const n=document.createElement("link");return n.rel=e?"stylesheet":"modulepreload",e||(n.as="script"),n.crossOrigin="",n.href=t,s&&n.setAttribute("nonce",s),document.head.appendChild(n),e?new Promise((e,s)=>{n.addEventListener("load",e),n.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${t}`)))}):void 0}))}function n(t){const e=new Event("vite:preloadError",{cancelable:!0});if(e.payload=t,window.dispatchEvent(e),!e.defaultPrevented)throw t}return i.then(e=>{for(const t of e||[])"rejected"===t.status&&n(t.reason);return t().catch(n)})};var it=(t=>(t.Application="application",t.WebGLPipes="webgl-pipes",t.WebGLPipesAdaptor="webgl-pipes-adaptor",t.WebGLSystem="webgl-system",t.WebGPUPipes="webgpu-pipes",t.WebGPUPipesAdaptor="webgpu-pipes-adaptor",t.WebGPUSystem="webgpu-system",t.CanvasSystem="canvas-system",t.CanvasPipesAdaptor="canvas-pipes-adaptor",t.CanvasPipes="canvas-pipes",t.Asset="asset",t.LoadParser="load-parser",t.ResolveParser="resolve-parser",t.CacheParser="cache-parser",t.DetectionParser="detection-parser",t.MaskEffect="mask-effect",t.BlendMode="blend-mode",t.TextureSource="texture-source",t.Environment="environment",t.ShapeBuilder="shape-builder",t.Batcher="batcher",t))(it||{});const nt=t=>{if("function"==typeof t||"object"==typeof t&&t.extension){if(!t.extension)throw new Error("Extension class must have an extension object");t={..."object"!=typeof t.extension?{type:t.extension}:t.extension,ref:t}}if("object"!=typeof t)throw new Error("Invalid extension type");return"string"==typeof(t={...t}).type&&(t.type=[t.type]),t},rt=(t,e)=>nt(t).priority??e,at={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...t){return t.map(nt).forEach(t=>{t.type.forEach(e=>this._removeHandlers[e]?.(t))}),this},add(...t){return t.map(nt).forEach(t=>{t.type.forEach(e=>{const s=this._addHandlers,i=this._queue;s[e]?s[e]?.(t):(i[e]=i[e]||[],i[e]?.push(t))})}),this},handle(t,e,s){const i=this._addHandlers,n=this._removeHandlers;if(i[t]||n[t])throw new Error(`Extension type ${t} already has a handler`);i[t]=e,n[t]=s;const r=this._queue;return r[t]&&(r[t]?.forEach(t=>e(t)),delete r[t]),this},handleByMap(t,e){return this.handle(t,t=>{t.name&&(e[t.name]=t.ref)},t=>{t.name&&delete e[t.name]})},handleByNamedList(t,e,s=-1){return this.handle(t,t=>{e.findIndex(e=>e.name===t.name)>=0||(e.push({name:t.name,value:t.ref}),e.sort((t,e)=>rt(e.value,s)-rt(t.value,s)))},t=>{const s=e.findIndex(e=>e.name===t.name);-1!==s&&e.splice(s,1)})},handleByList(t,e,s=-1){return this.handle(t,t=>{e.includes(t.ref)||(e.push(t.ref),e.sort((t,e)=>rt(e,s)-rt(t,s)))},t=>{const s=e.indexOf(t.ref);-1!==s&&e.splice(s,1)})},mixin(t,...e){for(const s of e)Object.defineProperties(t.prototype,Object.getOwnPropertyDescriptors(s))}},ot={extension:{type:it.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await st(()=>Promise.resolve().then(()=>gr),void 0)}},ht={extension:{type:it.Environment,name:"webworker",priority:0},test:()=>"undefined"!=typeof self&&void 0!==self.WorkerGlobalScope,load:async()=>{await st(()=>Promise.resolve().then(()=>_r),void 0)}};class lt{constructor(t,e,s){this._x=e||0,this._y=s||0,this._observer=t}clone(t){return new lt(t??this._observer,this._x,this._y)}set(t=0,e=t){return this._x===t&&this._y===e||(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}const ct=2*Math.PI,dt=180/Math.PI,ut=Math.PI/180;class pt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new pt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return ft.x=0,ft.y=0,ft}}const ft=new pt;class mt{constructor(t=1,e=0,s=0,i=1,n=0,r=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=i,this.tx=n,this.ty=r}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,i,n,r){return this.a=t,this.b=e,this.c=s,this.d=i,this.tx=n,this.ty=r,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new pt;const s=t.x,i=t.y;return e.x=this.a*s+this.c*i+this.tx,e.y=this.b*s+this.d*i+this.ty,e}applyInverse(t,e){e=e||new pt;const s=this.a,i=this.b,n=this.c,r=this.d,a=this.tx,o=this.ty,h=1/(s*r+n*-i),l=t.x,c=t.y;return e.x=r*h*l+-n*h*c+(o*n-a*r)*h,e.y=s*h*c+-i*h*l+(-o*s+a*i)*h,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),i=this.a,n=this.c,r=this.tx;return this.a=i*e-this.b*s,this.b=i*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=r*e-this.ty*s,this.ty=r*s+this.ty*e,this}append(t){const e=this.a,s=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}appendFrom(t,e){const s=t.a,i=t.b,n=t.c,r=t.d,a=t.tx,o=t.ty,h=e.a,l=e.b,c=e.c,d=e.d;return this.a=s*h+i*c,this.b=s*l+i*d,this.c=n*h+r*c,this.d=n*l+r*d,this.tx=a*h+o*c+e.tx,this.ty=a*l+o*d+e.ty,this}setTransform(t,e,s,i,n,r,a,o,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-o)*r,this.d=Math.cos(a-o)*r,this.tx=t-(s*this.a+i*this.c),this.ty=e-(s*this.b+i*this.d),this}prepend(t){const e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){const e=this.a,s=this.c;this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=s*t.a+this.d*t.c,this.d=s*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,i=this.c,n=this.d,r=t.pivot,a=-Math.atan2(-i,n),o=Math.atan2(s,e),h=Math.abs(a+o);return h<1e-5||Math.abs(ct-h)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=o),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx+(r.x*e+r.y*i),t.position.y=this.ty+(r.x*s+r.y*n),t}invert(){const t=this.a,e=this.b,s=this.c,i=this.d,n=this.tx,r=t*i-e*s;return this.a=i/r,this.b=-e/r,this.c=-s/r,this.d=t/r,this.tx=(s*this.ty-i*n)/r,this.ty=-(t*this.ty-e*n)/r,this}isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.tx&&0===this.ty}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new mt;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return _t.identity()}static get shared(){return gt.identity()}}const gt=new mt,_t=new mt,yt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],vt=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],xt=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],bt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],At=[],wt=[],Tt=Math.sign;!function(){for(let t=0;t<16;t++){const e=[];At.push(e);for(let s=0;s<16;s++){const i=Tt(yt[t]*yt[s]+xt[t]*vt[s]),n=Tt(vt[t]*yt[s]+bt[t]*vt[s]),r=Tt(yt[t]*xt[s]+xt[t]*bt[s]),a=Tt(vt[t]*xt[s]+bt[t]*bt[s]);for(let t=0;t<16;t++)if(yt[t]===i&&vt[t]===n&&xt[t]===r&&bt[t]===a){e.push(t);break}}}for(let t=0;t<16;t++){const e=new mt;e.set(yt[t],vt[t],xt[t],bt[t],0,0),wt.push(e)}}();const Et={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:t=>yt[t],uY:t=>vt[t],vX:t=>xt[t],vY:t=>bt[t],inv:t=>8&t?15&t:7&-t,add:(t,e)=>At[t][e],sub:(t,e)=>At[t][Et.inv(e)],rotate180:t=>4^t,isVertical:t=>2==(3&t),byDirection:(t,e)=>2*Math.abs(t)<=Math.abs(e)?e>=0?Et.S:Et.N:2*Math.abs(e)<=Math.abs(t)?t>0?Et.E:Et.W:e>0?t>0?Et.SE:Et.SW:t>0?Et.NE:Et.NW,matrixAppendRotationInv:(t,e,s=0,i=0)=>{const n=wt[Et.inv(e)];n.tx=s,n.ty=i,t.append(n)},transformRectCoords:(t,e,s,i)=>{const{x:n,y:r,width:a,height:o}=t,{x:h,y:l,width:c,height:d}=e;return s===Et.E?(i.set(n+h,r+l,a,o),i):s===Et.S?i.set(c-r-o+h,n+l,o,a):s===Et.W?i.set(c-n-a+h,d-r-o+l,a,o):s===Et.N?i.set(r+h,d-n-a+l,o,a):i.set(n+h,r+l,a,o)}},Pt=[new pt,new pt,new pt,new pt];class St{constructor(t=0,e=0,s=0,i=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new St(0,0,0,0)}clone(){return new St(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)}strokeContains(t,e,s,i=.5){const{width:n,height:r}=this;if(n<=0||r<=0)return!1;const a=this.x,o=this.y,h=s*(1-i),l=s-h;return t>=a-h&&t<=a+n+h&&e>=o-h&&e<=o+r+h&&!(t>a+l&&t<a+n-l&&e>o+l&&e<o+r-l)}intersects(t,e){if(!e){const e=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=e)return!1;const s=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>s}const s=this.left,i=this.right,n=this.top,r=this.bottom;if(i<=s||r<=n)return!1;const a=Pt[0].set(t.left,t.top),o=Pt[1].set(t.left,t.bottom),h=Pt[2].set(t.right,t.top),l=Pt[3].set(t.right,t.bottom);if(h.x<=a.x||o.y<=a.y)return!1;const c=Math.sign(e.a*e.d-e.b*e.c);if(0===c)return!1;if(e.apply(a,a),e.apply(o,o),e.apply(h,h),e.apply(l,l),Math.max(a.x,o.x,h.x,l.x)<=s||Math.min(a.x,o.x,h.x,l.x)>=i||Math.max(a.y,o.y,h.y,l.y)<=n||Math.min(a.y,o.y,h.y,l.y)>=r)return!1;const d=c*(o.y-a.y),u=c*(a.x-o.x),p=d*s+u*n,f=d*i+u*n,m=d*s+u*r,g=d*i+u*r;if(Math.max(p,f,m,g)<=d*a.x+u*a.y||Math.min(p,f,m,g)>=d*l.x+u*l.y)return!1;const _=c*(a.y-h.y),y=c*(h.x-a.x),v=_*s+y*n,x=_*i+y*n,b=_*s+y*r,A=_*i+y*r;return!(Math.max(v,x,b,A)<=_*a.x+y*a.y||Math.min(v,x,b,A)>=_*l.x+y*l.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=i,this.height=Math.max(n-i,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=i-this.y,this}scale(t,e=t){return this.x*=t,this.y*=e,this.width*=t,this.height*=e,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=i,this.height=n-i,this}getBounds(t){return t||(t=new St),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,s=t.y,i=t.x+t.width,n=t.y+t.height;return e>=this.x&&e<this.x+this.width&&s>=this.y&&s<this.y+this.height&&i>=this.x&&i<this.x+this.width&&n>=this.y&&n<this.y+this.height}set(t,e,s,i){return this.x=t,this.y=e,this.width=s,this.height=i,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const Mt={default:-1};function kt(t="default"){return void 0===Mt[t]&&(Mt[t]=-1),++Mt[t]}const Ct=new Set,Bt="8.0.0",It="8.3.4",Ot={quiet:!1,noColor:!1},Ft=(t,e,s=3)=>{if(Ot.quiet||Ct.has(e))return;let i=(new Error).stack;"function"==typeof console.groupCollapsed&&Ot.noColor;void 0===i||(i=i.split("\n").splice(s).join("\n")),Ct.add(e)};Object.defineProperties(Ft,{quiet:{get:()=>Ot.quiet,set:t=>{Ot.quiet=t},enumerable:!0,configurable:!1},noColor:{get:()=>Ot.noColor,set:t=>{Ot.noColor=t},enumerable:!0,configurable:!1}});const Rt=()=>{};function Lt(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function Dt(t){return!(t&t-1||!t)}function Ut(t,e,s){const{width:i,height:n}=s.orig,r=s.trim;if(r){const s=r.width,a=r.height;t.minX=r.x-e._x*i,t.maxX=t.minX+s,t.minY=r.y-e._y*n,t.maxY=t.minY+a}else t.minX=-e._x*i,t.maxX=t.minX+i,t.minY=-e._y*n,t.maxY=t.minY+n}o([h]);const zt=class t{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(e){if(e instanceof t)this._value=this._cloneSource(e._value),this._int=e._int,this._components.set(e._components);else{if(null===e)throw new Error("Cannot set Color#value to null");null!==this._value&&this._isSourceEqual(this._value,e)||(this._value=this._cloneSource(e),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return"string"==typeof t||"number"==typeof t||t instanceof Number||null===t?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):"object"==typeof t&&null!==t?{...t}:t}_isSourceEqual(t,e){const s=typeof t;if(s!==typeof e)return!1;if("number"===s||"string"===s||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length===e.length&&t.every((t,s)=>t===e[s]);if(null!==t&&null!==e){const s=Object.keys(t),i=Object.keys(e);return s.length===i.length&&s.every(s=>t[s]===e[s])}return t===e}toRgba(){const[t,e,s,i]=this._components;return{r:t,g:e,b:s,a:i}}toRgb(){const[t,e,s]=this._components;return{r:t,g:e,b:s}}toRgbaString(){const[t,e,s]=this.toUint8RgbArray();return`rgba(${t},${e},${s},${this.alpha})`}toUint8RgbArray(t){const[e,s,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(255*e),t[1]=Math.round(255*s),t[2]=Math.round(255*i),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,s,i,n]=this._components;return t[0]=e,t[1]=s,t[2]=i,t[3]=n,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,s,i]=this._components;return t[0]=e,t[1]=s,t[2]=i,t}toNumber(){return this._int}toBgrNumber(){const[t,e,s]=this.toUint8RgbArray();return(s<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(65280&t)+((255&t)<<16)}multiply(e){const[s,i,n,r]=t._temp.setValue(e)._components;return this._components[0]*=s,this._components[1]*=i,this._components[2]*=n,this._components[3]*=r,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(1===t)return(255<<24)+this._int;if(0===t)return e?0:this._int;let s=this._int>>16&255,i=this._int>>8&255,n=255&this._int;return e&&(s=s*t+.5|0,i=i*t+.5|0,n=n*t+.5|0),(255*t<<24)+(s<<16)+(i<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const t=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-t.length)+t}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(e){let s,i,n,r;if(("number"==typeof e||e instanceof Number)&&e>=0&&e<=16777215){s=(e>>16&255)/255,i=(e>>8&255)/255,n=(255&e)/255,r=1}else if((Array.isArray(e)||e instanceof Float32Array)&&e.length>=3&&e.length<=4)e=this._clamp(e),[s,i,n,r=1]=e;else if((e instanceof Uint8Array||e instanceof Uint8ClampedArray)&&e.length>=3&&e.length<=4)e=this._clamp(e,0,255),[s,i,n,r=255]=e,s/=255,i/=255,n/=255,r/=255;else if("string"==typeof e||"object"==typeof e){if("string"==typeof e){const s=t.HEX_PATTERN.exec(e);s&&(e=`#${s[2]}`)}const o=a(e);o.isValid()&&(({r:s,g:i,b:n,a:r}=o.rgba),s/=255,i/=255,n/=255)}if(void 0===s)throw new Error(`Unable to convert color ${e}`);this._components[0]=s,this._components[1]=i,this._components[2]=n,this._components[3]=r,this._refreshInt()}_refreshInt(){this._clamp(this._components);const[t,e,s]=this._components;this._int=(255*t<<16)+(255*e<<8)+(255*s|0)}_clamp(t,e=0,s=1){return"number"==typeof t?Math.min(Math.max(t,e),s):(t.forEach((i,n)=>{t[n]=Math.min(Math.max(i,e),s)}),t)}static isColorLike(e){return"number"==typeof e||"string"==typeof e||e instanceof Number||e instanceof t||Array.isArray(e)||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Float32Array||void 0!==e.r&&void 0!==e.g&&void 0!==e.b||void 0!==e.r&&void 0!==e.g&&void 0!==e.b&&void 0!==e.a||void 0!==e.h&&void 0!==e.s&&void 0!==e.l||void 0!==e.h&&void 0!==e.s&&void 0!==e.l&&void 0!==e.a||void 0!==e.h&&void 0!==e.s&&void 0!==e.v||void 0!==e.h&&void 0!==e.s&&void 0!==e.v&&void 0!==e.a}};zt.shared=new zt,zt._temp=new zt,zt.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Wt=zt;const $t={cullArea:null,cullable:!1,cullableChildren:!0};let Gt=0;function jt(...t){500!==Gt&&Gt++}const Nt={_registeredResources:new Set,register(t){this._registeredResources.add(t)},unregister(t){this._registeredResources.delete(t)},release(){this._registeredResources.forEach(t=>t.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(t){return this._registeredResources.has(t)},reset(){this._registeredResources.clear()}};class Ht{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){let e;return e=this._index>0?this._pool[--this._index]:new this._classType,e.init?.(t),e}return(t){t.reset?.(),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let t=0;t<this._index;t++)this._pool[t].destroy();this._pool.length=0,this._count=0,this._index=0}}const Vt=new class{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Ht(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const s=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[s]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}clear(){this._poolsByClass.forEach(t=>t.clear()),this._poolsByClass.clear()}};function Xt(t,e,s){const i=t.length;let n;if(e>=i||0===s)return;const r=i-(s=e+s>i?i-e:s);for(n=e;n<r;++n)t[n]=t[n+s];t.length=r}Nt.register(Vt);const Yt=new class{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const s=this._tests[e];if(s.test(t))return Vt.get(s.maskClass,t)}return t}returnMaskEffect(t){Vt.return(t)}};at.handleByList(it.MaskEffect,Yt._effectClasses);class Kt extends t{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new e(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:s,y:i}=t;return s>=e.minX&&s<=e.maxX&&i>=e.minY&&i<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null;for(const e in this._gpuData)this._gpuData[e].destroy?.();this._gpuData=null}collectRenderablesSimple(t,e,s){const{renderPipes:i}=e;i.blendMode.pushBlendMode(this,this.groupBlendMode,t);i[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const n=this.children,r=n.length;for(let a=0;a<r;a++)n[a].collectRenderables(t,e,s);i.blendMode.popBlendMode(t)}}const qt=new e;function Qt(t,e,i){const n=qt;t.measurable=!0,s(t,i,n),e.addBoundsMask(n),t.measurable=!1}function Zt(t,e,s){const a=i.get();t.measurable=!0;const o=n.get().identity(),h=Jt(t,s,o);r(t,a,h),t.measurable=!1,e.addBoundsMask(a),n.return(o),i.return(a)}function Jt(t,e,s){return t?(t!==e&&(Jt(t.parent,e,s),t.updateLocalTransform(),s.append(t.localTransform)),s):(jt(),s)}class te{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof V),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(t,e){this.inverse||Qt(this.mask,t,e)}addLocalBounds(t,e){Zt(this.mask,t,e)}containsPoint(t,e){return e(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof V}}te.extension=it.MaskEffect;class ee{constructor(t){this.priority=0,this.pipe="colorMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return"number"==typeof t}}ee.extension=it.MaskEffect;class se{constructor(t){this.priority=0,this.pipe="stencilMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(t,e){Qt(this.mask,t,e)}addLocalBounds(t,e){Zt(this.mask,t,e)}containsPoint(t,e){return e(this.mask,t)}destroy(){this.reset()}static test(e){return e instanceof t}}se.extension=it.MaskEffect;let ie={createCanvas:(t,e)=>{const s=document.createElement("canvas");return s.width=t,s.height=e,s},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(t,e)=>fetch(t,e),parseXML:t=>(new DOMParser).parseFromString(t,"text/xml")};const ne={get:()=>ie,set(t){ie=t}};var re=(t=>(t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY",t))(re||{});class ae{constructor(t,e=null,s=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=s,this._once=i}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const oe=class t{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ae(null,null,1/0),this.deltaMS=1/t.targetFPMS,this.elapsedMS=1/t.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,s=re.NORMAL){return this._addListener(new ae(t,e,s))}addOnce(t,e,s=re.NORMAL){return this._addListener(new ae(t,e,s,!0))}_addListener(t){let e=this._head.next,s=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}else t.connect(s);return this._startIfPossible(),this}remove(t,e){let s=this._head.next;for(;s;)s=s.match(t,e)?s.destroy():s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(e=performance.now()){let s;if(e>this.lastTime){if(s=this.elapsedMS=e-this.lastTime,s>this._maxElapsedMS&&(s=this._maxElapsedMS),s*=this.speed,this._minElapsedMS){const t=e-this._lastFrame|0;if(t<this._minElapsedMS)return;this._lastFrame=e-t%this._minElapsedMS}this.deltaMS=s,this.deltaTime=this.deltaMS*t.targetFPMS;const i=this._head;let n=i.next;for(;n;)n=n.emit(this);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(e){const s=Math.min(this.maxFPS,e),i=Math.min(Math.max(0,s)/1e3,t.targetFPMS);this._maxElapsedMS=1/i}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(0===t)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!t._shared){const e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared}static get system(){if(!t._system){const e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system}};oe.targetFPMS=.06;let he,le=oe;async function ce(){return he??(he=(async()=>{const t=ne.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(t=>{const e=document.createElement("video");e.onloadeddata=()=>t(e),e.onerror=()=>t(null),e.autoplay=!1,e.crossOrigin="anonymous",e.preload="auto",e.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",e.load()});if(!e)return"premultiply-alpha-on-upload";const s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,n),t.deleteFramebuffer(i),t.deleteTexture(s),t.getExtension("WEBGL_lose_context")?.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),he}const de=(t,e,s=!1)=>(Array.isArray(t)||(t=[t]),e?t.map(t=>"string"==typeof t||s?e(t):t):t);const ue=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||jt(),e}set(t,e){const s=de(t);let i;for(let o=0;o<this.parsers.length;o++){const t=this.parsers[o];if(t.test(e)){i=t.getCacheableAssets(s,e);break}}const n=new Map(Object.entries(i||{}));i||s.forEach(t=>{n.set(t,e)});const r=[...n.keys()],a={cacheKeys:r,keys:s};s.forEach(t=>{this._cacheMap.set(t,a)}),r.forEach(t=>{const s=i?i[t]:e;this._cache.has(t)&&this._cache.get(t)!==s&&jt(),this._cache.set(t,n.get(t))})}remove(t){if(!this._cacheMap.has(t))return void jt();const e=this._cacheMap.get(t);e.cacheKeys.forEach(t=>{this._cache.delete(t)}),e.keys.forEach(t=>{this._cacheMap.delete(t)})}get parsers(){return this._parsers}};at.add(te,ee,se,p,f,m,g);var pe=(t=>(t[t.Low=0]="Low",t[t.Normal=1]="Normal",t[t.High=2]="High",t))(pe||{});function fe(t){if("string"!=typeof t)throw new TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function me(t){return t.split("?")[0].split("#")[0]}const ge={toPosix(t){return e="\\",s="/",t.replace(new RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),s);var e,s},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),isBlobUrl:t=>t.startsWith("blob:"),hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){fe(t),t=this.toPosix(t);const e=/^file:\/\/\//.exec(t);if(e)return e[0];const s=/^[^/:]+:\/{0,2}/.exec(t);return s?s[0]:""},toAbsolute(t,e,s){if(fe(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;const i=me(this.toPosix(e??ne.get().getBaseUrl())),n=me(this.toPosix(s??this.rootname(i)));if((t=this.toPosix(t)).startsWith("/"))return ge.join(n,t.slice(1));return this.isAbsolute(t)?t:this.join(i,t)},normalize(t){if(fe(t),0===t.length)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;let e="";const s=(t=this.toPosix(t)).startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));const i=t.endsWith("/");return(t=function(t){let e="",s=0,i=-1,n=0,r=-1;for(let a=0;a<=t.length;++a){if(a<t.length)r=t.charCodeAt(a);else{if(47===r)break;r=47}if(47===r){if(i===a-1||1===n);else if(i!==a-1&&2===n){if(e.length<2||2!==s||46!==e.charCodeAt(e.length-1)||46!==e.charCodeAt(e.length-2))if(e.length>2){const t=e.lastIndexOf("/");if(t!==e.length-1){-1===t?(e="",s=0):(e=e.slice(0,t),s=e.length-1-e.lastIndexOf("/")),i=a,n=0;continue}}else if(2===e.length||1===e.length){e="",s=0,i=a,n=0;continue}}else e.length>0?e+=`/${t.slice(i+1,a)}`:e=t.slice(i+1,a),s=a-i-1;i=a,n=0}else 46===r&&-1!==n?++n:n=-1}return e}(t)).length>0&&i&&(t+="/"),s?`/${t}`:e+t},isAbsolute(t){return fe(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){if(0===t.length)return".";let e;for(let s=0;s<t.length;++s){const i=t[s];if(fe(i),i.length>0)if(void 0===e)e=i;else{const n=t[s-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?e+=`/../${i}`:e+=`/${i}`}}return void 0===e?".":this.normalize(e)},dirname(t){if(fe(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0);const s=47===e;let i=-1,n=!0;const r=this.getProtocol(t),a=t;for(let o=(t=t.slice(r.length)).length-1;o>=1;--o)if(e=t.charCodeAt(o),47===e){if(!n){i=o;break}}else n=!1;return-1===i?s?"/":this.isUrl(a)?r+t:r:s&&1===i?"//":r+t.slice(0,i)},rootname(t){fe(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){const s=t.indexOf("/",e.length);e=-1!==s?t.slice(0,s):t,e.endsWith("/")||(e+="/")}return e},basename(t,e){fe(t),e&&fe(e),t=me(this.toPosix(t));let s,i=0,n=-1,r=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let a=e.length-1,o=-1;for(s=t.length-1;s>=0;--s){const h=t.charCodeAt(s);if(47===h){if(!r){i=s+1;break}}else-1===o&&(r=!1,o=s+1),a>=0&&(h===e.charCodeAt(a)?-1===--a&&(n=s):(a=-1,n=o))}return i===n?n=o:-1===n&&(n=t.length),t.slice(i,n)}for(s=t.length-1;s>=0;--s)if(47===t.charCodeAt(s)){if(!r){i=s+1;break}}else-1===n&&(r=!1,n=s+1);return-1===n?"":t.slice(i,n)},extname(t){fe(t);let e=-1,s=0,i=-1,n=!0,r=0;for(let a=(t=me(this.toPosix(t))).length-1;a>=0;--a){const o=t.charCodeAt(a);if(47!==o)-1===i&&(n=!1,i=a+1),46===o?-1===e?e=a:1!==r&&(r=1):-1!==e&&(r=-1);else if(!n){s=a+1;break}}return-1===e||-1===i||0===r||1===r&&e===i-1&&e===s+1?"":t.slice(e,i)},parse(t){fe(t);const e={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return e;let s=(t=me(this.toPosix(t))).charCodeAt(0);const i=this.isAbsolute(t);let n;e.root=this.rootname(t),n=i||this.hasProtocol(t)?1:0;let r=-1,a=0,o=-1,h=!0,l=t.length-1,c=0;for(;l>=n;--l)if(s=t.charCodeAt(l),47!==s)-1===o&&(h=!1,o=l+1),46===s?-1===r?r=l:1!==c&&(c=1):-1!==r&&(c=-1);else if(!h){a=l+1;break}return-1===r||-1===o||0===c||1===c&&r===o-1&&r===a+1?-1!==o&&(e.base=e.name=0===a&&i?t.slice(1,o):t.slice(a,o)):(0===a&&i?(e.name=t.slice(1,r),e.base=t.slice(1,o)):(e.name=t.slice(a,r),e.base=t.slice(a,o)),e.ext=t.slice(r,o)),e.dir=this.dirname(t),e},sep:"/",delimiter:":",joinExtensions:[".html"]};function _e(t,e,s,i,n){const r=e[s];for(let a=0;a<r.length;a++){const o=r[a];s<e.length-1?_e(t.replace(i[s],o),e,s+1,i,n):n.push(t.replace(i[s],o))}}function ye(t){const e=t.match(/\{(.*?)\}/g),s=[];if(e){const i=[];e.forEach(t=>{const e=t.substring(1,t.length-1).split(",");i.push(e)}),_e(t,i,0,e,s)}else s.push(t);return s}const ve=t=>!Array.isArray(t);class xe{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if("string"==typeof t)this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}}getAlias(t){const{alias:e,src:s}=t;return de(e||s,t=>"string"==typeof t?t:Array.isArray(t)?t.map(t=>t?.src??t):t?.src?t.src:t,!0)}addManifest(t){this._manifest&&jt(),this._manifest=t,t.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(t,e){const s=[];let i=e;Array.isArray(e)||(i=Object.entries(e).map(([t,e])=>"string"==typeof e||Array.isArray(e)?{alias:t,src:e}:{alias:t,...e})),i.forEach(e=>{const i=e.src,n=e.alias;let r;if("string"==typeof n){const e=this._createBundleAssetId(t,n);s.push(e),r=[n,e]}else{const e=n.map(e=>this._createBundleAssetId(t,e));s.push(...e),r=[...n,...e]}this.add({...e,alias:r,src:i})}),this._bundles[t]=s}add(t){const e=[];let s;Array.isArray(t)?e.push(...t):e.push(t),s=t=>{this.hasKey(t)&&jt()};de(e).forEach(t=>{const{src:e}=t;let{data:i,format:n,loadParser:r,parser:a}=t;const o=de(e).map(t=>"string"==typeof t?ye(t):Array.isArray(t)?t:[t]),h=this.getAlias(t);Array.isArray(h)?h.forEach(s):s(h);const l=[];o.forEach(e=>{e.forEach(e=>{let s={};if("object"!=typeof e){s.src=e;for(let t=0;t<this._parsers.length;t++){const i=this._parsers[t];if(i.test(e)){s=i.parse(e);break}}}else i=e.data??i,n=e.format??n,(e.loadParser||e.parser)&&(r=e.loadParser??r,a=e.parser??a),s={...s,...e};if(!h)throw new Error(`[Resolver] alias is undefined for this asset: ${s.src}`);s=this._buildResolvedAsset(s,{aliases:h,data:i,format:n,loadParser:r,parser:a,progressSize:t.progressSize}),l.push(s)})}),h.forEach(t=>{this._assetMap[t]=l})})}resolveBundle(t){const e=ve(t);t=de(t);const s={};return t.forEach(t=>{const e=this._bundles[t];if(e){const i=this.resolve(e),n={};for(const e in i){const s=i[e];n[this._extractAssetIdFromBundle(t,e)]=s}s[t]=n}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if("string"!=typeof t){const t={};for(const s in e)t[s]=e[s].src;return t}return e.src}resolve(t){const e=ve(t);t=de(t);const s={};return t.forEach(t=>{if(!this._resolverHash[t])if(this._assetMap[t]){let e=this._assetMap[t];const s=this._getPreferredOrder(e);s?.priority.forEach(t=>{s.params[t].forEach(s=>{const i=e.filter(e=>!!e[t]&&e[t]===s);i.length&&(e=i)})}),this._resolverHash[t]=e[0]}else this._resolverHash[t]=this._buildResolvedAsset({alias:[t],src:t},{});s[t]=this._resolverHash[t]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[e],i=this._preferredOrder.find(t=>t.params.format.includes(s.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;return`${t}${/\?/.test(t)?"&":"?"}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:s,data:i,loadParser:n,parser:r,format:a,progressSize:o}=e;return(this._basePath||this._rootPath)&&(t.src=ge.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=s??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...i||{},...t.data},t.loadParser=n??t.loadParser,t.parser=r??t.parser,t.format=a??t.format??t.src.split(".").pop().split("?").shift().split("#").shift(),void 0!==o&&(t.progressSize=o),t}}xe.RETINA_PREFIX=/@([0-9\.]+)x/;const be=(t,e)=>{const s=e.split("?")[1];return s&&(t+=`?${s}`),t};class Ae{constructor(t){this._lastTransform="",this._observer=null,this._tickerAttached=!1,this.updateTranslation=()=>{if(!this._canvas)return;const t=this._canvas.getBoundingClientRect(),e=this._canvas.width,s=this._canvas.height,i=t.width/e*this._renderer.resolution,n=t.height/s*this._renderer.resolution,r=`translate(${t.left}px, ${t.top}px) scale(${i}, ${n})`;r!==this._lastTransform&&(this._domElement.style.transform=r,this._lastTransform=r)},this._domElement=t.domElement,this._renderer=t.renderer,globalThis.OffscreenCanvas&&this._renderer.canvas instanceof OffscreenCanvas||(this._canvas=this._renderer.canvas,this._attachObserver())}get canvas(){return this._canvas}ensureAttached(){!this._domElement.parentNode&&this._canvas.parentNode&&(this._canvas.parentNode.appendChild(this._domElement),this.updateTranslation())}_attachObserver(){"ResizeObserver"in globalThis?(this._observer&&(this._observer.disconnect(),this._observer=null),this._observer=new ResizeObserver(t=>{for(const e of t){if(e.target!==this._canvas)continue;const t=this.canvas.width,s=this.canvas.height,i=e.contentRect.width/t*this._renderer.resolution,n=e.contentRect.height/s*this._renderer.resolution;(this._lastScaleX!==i||this._lastScaleY!==n)&&(this.updateTranslation(),this._lastScaleX=i,this._lastScaleY=n)}}),this._observer.observe(this._canvas)):this._tickerAttached||le.shared.add(this.updateTranslation,this,re.HIGH)}destroy(){this._observer?(this._observer.disconnect(),this._observer=null):this._tickerAttached&&le.shared.remove(this.updateTranslation),this._domElement=null,this._renderer=null,this._canvas=null,this._tickerAttached=!1,this._lastTransform="",this._lastScaleX=null,this._lastScaleY=null}}class we{constructor(t){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=we.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new pt,this.page=new pt,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=t}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(t,e,s){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(t,e,s,i,n){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}const Te=(l.default??l)(globalThis.navigator),Ee=class t{constructor(t,e=Te){this._mobileInfo=e,this.debug=!1,this._activateOnTab=!0,this._deactivateOnMouseMove=!0,this._isActive=!1,this._isMobileAccessibility=!1,this._div=null,this._pools={},this._renderId=0,this._children=[],this._androidUpdateCount=0,this._androidUpdateFrequency=500,this._isRunningTests=!1,this._boundOnKeyDown=this._onKeyDown.bind(this),this._boundOnMouseMove=this._onMouseMove.bind(this),this._hookDiv=null,(e.tablet||e.phone)&&this._createTouchHook(),this._renderer=t}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}get hookDiv(){return this._hookDiv}get div(){return this._div}_createTouchHook(){const t=document.createElement("button");t.style.width="1px",t.style.height="1px",t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.zIndex=2..toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessibility for this content",t.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this._activate(),this._destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t}_destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}_activate(){if(this._isActive)return;this._isActive=!0,this._div||(this._div=document.createElement("div"),this._div.style.position="absolute",this._div.style.top="0px",this._div.style.left="0px",this._div.style.pointerEvents="none",this._div.style.zIndex=2..toString(),this._canvasObserver=new Ae({domElement:this._div,renderer:this._renderer})),this._activateOnTab&&globalThis.addEventListener("keydown",this._boundOnKeyDown,!1),this._deactivateOnMouseMove&&globalThis.document.addEventListener("mousemove",this._boundOnMouseMove,!0);const t=this._renderer.view.canvas;if(t.parentNode)this._canvasObserver.ensureAttached(),this._initAccessibilitySetup();else{const e=new MutationObserver(()=>{t.parentNode&&(e.disconnect(),this._canvasObserver.ensureAttached(),this._initAccessibilitySetup())});e.observe(document.body,{childList:!0,subtree:!0})}}_initAccessibilitySetup(){this._renderer.runners.postrender.add(this),this._renderer.lastObjectRendered&&this._updateAccessibleObjects(this._renderer.lastObjectRendered)}_deactivate(){if(this._isActive&&!this._isMobileAccessibility){this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._boundOnMouseMove,!0),this._activateOnTab&&globalThis.addEventListener("keydown",this._boundOnKeyDown,!1),this._renderer.runners.postrender.remove(this);for(const t of this._children)t._accessibleDiv&&t._accessibleDiv.parentNode&&(t._accessibleDiv.parentNode.removeChild(t._accessibleDiv),t._accessibleDiv=null),t._accessibleActive=!1;for(const t in this._pools){this._pools[t].forEach(t=>{t.parentNode&&t.parentNode.removeChild(t)}),delete this._pools[t]}this._div&&this._div.parentNode&&this._div.parentNode.removeChild(this._div),this._pools={},this._children=[]}}_updateAccessibleObjects(t){if(!t.visible||!t.accessibleChildren)return;t.accessible&&(t._accessibleActive||this._addChild(t),t._renderId=this._renderId);const e=t.children;if(e)for(let s=0;s<e.length;s++)this._updateAccessibleObjects(e[s])}init(e){const s={accessibilityOptions:{...t.defaultOptions,...e?.accessibilityOptions||{}}};this.debug=s.accessibilityOptions.debug,this._activateOnTab=s.accessibilityOptions.activateOnTab,this._deactivateOnMouseMove=s.accessibilityOptions.deactivateOnMouseMove,s.accessibilityOptions.enabledByDefault&&this._activate(),this._renderer.runners.postrender.remove(this)}postrender(){const t=performance.now();if(this._mobileInfo.android.device&&t<this._androidUpdateCount)return;if(this._androidUpdateCount=t+this._androidUpdateFrequency,!(this._renderer.renderingToScreen&&this._renderer.view.canvas||this._isRunningTests))return;const e=new Set;if(this._renderer.lastObjectRendered){this._updateAccessibleObjects(this._renderer.lastObjectRendered);for(const t of this._children)t._renderId===this._renderId&&e.add(this._children.indexOf(t))}for(let s=this._children.length-1;s>=0;s--){const t=this._children[s];if(!e.has(s)){if(t._accessibleDiv&&t._accessibleDiv.parentNode){t._accessibleDiv.parentNode.removeChild(t._accessibleDiv);this._getPool(t.accessibleType).push(t._accessibleDiv),t._accessibleDiv=null}t._accessibleActive=!1,Xt(this._children,s,1)}}this._renderer.renderingToScreen&&this._canvasObserver.ensureAttached();for(let s=0;s<this._children.length;s++){const t=this._children[s];if(!t._accessibleActive||!t._accessibleDiv)continue;const e=t._accessibleDiv,i=t.hitArea||t.getBounds().rectangle;if(t.hitArea){const s=t.worldTransform;e.style.left=`${s.tx+i.x*s.a}px`,e.style.top=`${s.ty+i.y*s.d}px`,e.style.width=i.width*s.a+"px",e.style.height=i.height*s.d+"px"}else this._capHitArea(i),e.style.left=`${i.x}px`,e.style.top=`${i.y}px`,e.style.width=`${i.width}px`,e.style.height=`${i.height}px`}this._renderId++}_updateDebugHTML(t){t.innerHTML=`type: ${t.type}</br> title : ${t.title}</br> tabIndex: ${t.tabIndex}`}_capHitArea(t){t.x<0&&(t.width+=t.x,t.x=0),t.y<0&&(t.height+=t.y,t.y=0);const{width:e,height:s}=this._renderer;t.x+t.width>e&&(t.width=e-t.x),t.y+t.height>s&&(t.height=s-t.y)}_addChild(t){let e=this._getPool(t.accessibleType).pop();e?(e.innerHTML="",e.removeAttribute("title"),e.removeAttribute("aria-label"),e.tabIndex=0):("button"===t.accessibleType?e=document.createElement("button"):(e=document.createElement(t.accessibleType),e.style.cssText="\n                        color: transparent;\n                        pointer-events: none;\n                        padding: 0;\n                        margin: 0;\n                        border: 0;\n                        outline: 0;\n                        background: transparent;\n                        box-sizing: border-box;\n                        user-select: none;\n                        -webkit-user-select: none;\n                        -moz-user-select: none;\n                        -ms-user-select: none;\n                    ",t.accessibleText&&(e.innerText=t.accessibleText)),e.style.width="100px",e.style.height="100px",e.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",e.style.position="absolute",e.style.zIndex=2..toString(),e.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?e.setAttribute("aria-live","off"):e.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?e.setAttribute("aria-relevant","additions"):e.setAttribute("aria-relevant","text"),e.addEventListener("click",this._onClick.bind(this)),e.addEventListener("focus",this._onFocus.bind(this)),e.addEventListener("focusout",this._onFocusOut.bind(this))),e.style.pointerEvents=t.accessiblePointerEvents,e.type=t.accessibleType,t.accessibleTitle&&null!==t.accessibleTitle?e.title=t.accessibleTitle:t.accessibleHint&&null!==t.accessibleHint||(e.title=`container ${t.tabIndex}`),t.accessibleHint&&null!==t.accessibleHint&&e.setAttribute("aria-label",t.accessibleHint),t.interactive?e.tabIndex=t.tabIndex:e.tabIndex=0,this.debug&&this._updateDebugHTML(e),t._accessibleActive=!0,t._accessibleDiv=e,e.container=t,this._children.push(t),this._div.appendChild(t._accessibleDiv)}_dispatchEvent(t,e){const{container:s}=t.target,i=this._renderer.events.rootBoundary,n=Object.assign(new we(i),{target:s});i.rootTarget=this._renderer.lastObjectRendered,e.forEach(t=>i.dispatchEvent(n,t))}_onClick(t){this._dispatchEvent(t,["click","pointertap","tap"])}_onFocus(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","assertive"),this._dispatchEvent(t,["mouseover"])}_onFocusOut(t){t.target.getAttribute("aria-live")||t.target.setAttribute("aria-live","polite"),this._dispatchEvent(t,["mouseout"])}_onKeyDown(t){9===t.keyCode&&this._activateOnTab&&this._activate()}_onMouseMove(t){0===t.movementX&&0===t.movementY||this._deactivate()}destroy(){this._deactivate(),this._destroyTouchHook(),this._canvasObserver?.destroy(),this._canvasObserver=null,this._div=null,this._pools=null,this._children=null,this._renderer=null,this._hookDiv=null,globalThis.removeEventListener("keydown",this._boundOnKeyDown),this._boundOnKeyDown=null,globalThis.document.removeEventListener("mousemove",this._boundOnMouseMove,!0),this._boundOnMouseMove=null}setAccessibilityEnabled(t){t?this._activate():this._deactivate()}_getPool(t){return this._pools[t]||(this._pools[t]=[]),this._pools[t]}};Ee.extension={type:[it.WebGLSystem,it.WebGPUSystem],name:"accessibility"},Ee.defaultOptions={enabledByDefault:!1,debug:!1,activateOnTab:!0,deactivateOnMouseMove:!0};let Pe=Ee;const Se=[];async function Me(t){if(!t)for(let e=0;e<Se.length;e++){const t=Se[e];if(t.value.test())return void(await t.value.load())}}let ke;function Ce(){if("boolean"==typeof ke)return ke;try{const t=new Function("param1","param2","param3","return param1[param2] === param3;");ke=!0===t({a:"b"},"a","b")}catch(t){ke=!1}return ke}at.handleByNamedList(it.Environment,Se);const Be=c.default||c;let Ie,Oe;function Fe(t){return void 0!==Ie||(Ie=(()=>{const e={stencil:!0,failIfMajorPerformanceCaveat:t??_.defaultOptions.failIfMajorPerformanceCaveat};try{if(!ne.get().getWebGLRenderingContext())return!1;let t=ne.get().createCanvas().getContext("webgl",e);const s=!!t?.getContextAttributes()?.stencil;if(t){const e=t.getExtension("WEBGL_lose_context");e&&e.loseContext()}return t=null,s}catch(s){return!1}})()),Ie}async function Re(t={}){return void 0!==Oe||(Oe=await(async()=>{const e=ne.get().getNavigator().gpu;if(!e)return!1;try{const s=await e.requestAdapter(t);return await s.requestDevice(),!0}catch(s){return!1}})()),Oe}const Le="8.14.0";class De{static init(){globalThis.__PIXI_APP_INIT__?.(this,Le)}static destroy(){}}De.extension=it.Application;class Ue{constructor(t){this._renderer=t}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,Le)}destroy(){this._renderer=null}}Ue.extension={type:[it.WebGLSystem,it.WebGPUSystem],name:"initHook",priority:-10};const ze=class e{constructor(...e){this.stage=new t,void 0!==e[0]&&Ft(0,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await y(t),e._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return Ft(0,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,s=!1){const i=e._plugins.slice(0);i.reverse(),i.forEach(t=>{t.destroy.call(this)}),this.stage.destroy(s),this.stage=null,this.renderer.destroy(t),this.renderer=null}};ze._plugins=[];let We=ze;at.handleByList(it.Application,We._plugins),at.add(De);class $e{static init(t){Object.defineProperty(this,"resizeTo",{set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let t,e;if(this._cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,e=globalThis.innerHeight;else{const{clientWidth:s,clientHeight:i}=this._resizeTo;t=s,e=i}this.renderer.resize(t,e),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}$e.extension=it.Application;class Ge{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,re.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?le.shared:new le,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Ge.extension=it.Application;class je extends d{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return Ft(0,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return Ft(0,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return Ft(0,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return Ft(0,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return Ft(0,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners();for(const e in this.chars)this.chars[e].texture?.destroy();this.chars=null,t&&(this.pages.forEach(t=>t.texture.destroy(!0)),this.pages=null)}}const Ne=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function He(t){const e="number"==typeof t.fontSize?`${t.fontSize}px`:t.fontSize;let s=t.fontFamily;Array.isArray(t.fontFamily)||(s=t.fontFamily.split(","));for(let i=s.length-1;i>=0;i--){let t=s[i].trim();/([\"\'])[^\'\"]+\1/.test(t)||Ne.includes(t)||(t=`"${t}"`),s[i]=t}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${s.join(",")}`}const Ve={willReadFrequently:!0},Xe=class t{static get experimentalLetterSpacingSupported(){let e=t._experimentalLetterSpacingSupported;if(void 0===e){const s=ne.get().getCanvasRenderingContext2D().prototype;e=t._experimentalLetterSpacingSupported="letterSpacing"in s||"textLetterSpacing"in s}return e}constructor(t,e,s,i,n,r,a,o,h){this.text=t,this.style=e,this.width=s,this.height=i,this.lines=n,this.lineWidths=r,this.lineHeight=a,this.maxLineWidth=o,this.fontProperties=h}static measureText(e=" ",s,i=t._canvas,n=s.wordWrap){const r=`${e}-${s.styleKey}-wordWrap-${n}`;if(t._measurementCache.has(r))return t._measurementCache.get(r);const a=He(s),o=t.measureFont(a);0===o.fontSize&&(o.fontSize=s.fontSize,o.ascent=s.fontSize);const h=t.__context;h.font=a;const l=(n?t._wordWrap(e,s,i):e).split(/(?:\r\n|\r|\n)/),c=new Array(l.length);let d=0;for(let _=0;_<l.length;_++){const e=t._measureText(l[_],s.letterSpacing,h);c[_]=e,d=Math.max(d,e)}const u=s._stroke?.width||0;let p=d+u;s.dropShadow&&(p+=s.dropShadow.distance);const f=s.lineHeight||o.fontSize;let m=Math.max(f,o.fontSize+u)+(l.length-1)*(f+s.leading);s.dropShadow&&(m+=s.dropShadow.distance);const g=new t(e,s,p,m,l,c,f+s.leading,d,o);return t._measurementCache.set(r,g),g}static _measureText(e,s,i){let n=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(i.letterSpacing=`${s}px`,i.textLetterSpacing=`${s}px`,n=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));const r=i.measureText(e);let a=r.width;const o=-r.actualBoundingBoxLeft;let h=r.actualBoundingBoxRight-o;if(a>0)if(n)a-=s,h-=s;else{const i=(t.graphemeSegmenter(e).length-1)*s;a+=i,h+=i}return Math.max(a,h)}static _wordWrap(e,s,i=t._canvas){const n=i.getContext("2d",Ve);let r=0,a="",o="";const h=Object.create(null),{letterSpacing:l,whiteSpace:c}=s,d=t._collapseSpaces(c),u=t._collapseNewlines(c);let p=!d;const f=s.wordWrapWidth+l,m=t._tokenize(e);for(let g=0;g<m.length;g++){let e=m[g];if(t._isNewline(e)){if(!u){o+=t._addLine(a),p=!d,a="",r=0;continue}e=" "}if(d){const s=t.isBreakingSpace(e),i=t.isBreakingSpace(a[a.length-1]);if(s&&i)continue}const i=t._getFromCache(e,l,h,n);if(i>f)if(""!==a&&(o+=t._addLine(a),a="",r=0),t.canBreakWords(e,s.breakWords)){const i=t.wordWrapSplit(e);for(let c=0;c<i.length;c++){let d=i[c],u=d,m=1;for(;i[c+m];){const n=i[c+m];if(t.canBreakChars(u,n,e,c,s.breakWords))break;d+=n,u=n,m++}c+=m-1;const g=t._getFromCache(d,l,h,n);g+r>f&&(o+=t._addLine(a),p=!1,a="",r=0),a+=d,r+=g}}else{a.length>0&&(o+=t._addLine(a),a="",r=0);const s=g===m.length-1;o+=t._addLine(e,!s),p=!1,a="",r=0}else i+r>f&&(p=!1,o+=t._addLine(a),a="",r=0),(a.length>0||!t.isBreakingSpace(e)||p)&&(a+=e,r+=i)}return o+=t._addLine(a,!1),o}static _addLine(e,s=!0){return e=t._trimRight(e),e=s?`${e}\n`:e}static _getFromCache(e,s,i,n){let r=i[e];return"number"!=typeof r&&(r=t._measureText(e,s,n)+s,i[e]=r),r}static _collapseSpaces(t){return"normal"===t||"pre-line"===t}static _collapseNewlines(t){return"normal"===t}static _trimRight(e){if("string"!=typeof e)return"";for(let s=e.length-1;s>=0;s--){const i=e[s];if(!t.isBreakingSpace(i))break;e=e.slice(0,-1)}return e}static _isNewline(e){return"string"==typeof e&&t._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,s){return"string"==typeof e&&t._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){const s=[];let i="";if("string"!=typeof e)return s;for(let n=0;n<e.length;n++){const r=e[n],a=e[n+1];t.isBreakingSpace(r,a)||t._isNewline(r)?(""!==i&&(s.push(i),i=""),"\r"===r&&"\n"===a?(s.push("\r\n"),n++):s.push(r)):i+=r}return""!==i&&s.push(i),s}static canBreakWords(t,e){return e}static canBreakChars(t,e,s,i,n){return!0}static wordWrapSplit(e){return t.graphemeSegmenter(e)}static measureFont(e){if(t._fonts[e])return t._fonts[e];const s=t._context;s.font=e;const i=s.measureText(t.METRICS_STRING+t.BASELINE_SYMBOL),n={ascent:i.actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent,fontSize:i.actualBoundingBoxAscent+i.actualBoundingBoxDescent};return t._fonts[e]=n,n}static clearMetrics(e=""){e?delete t._fonts[e]:t._fonts={}}static get _canvas(){if(!t.__canvas){let s;try{const e=new OffscreenCanvas(0,0),i=e.getContext("2d",Ve);if(i?.measureText)return t.__canvas=e,e;s=ne.get().createCanvas()}catch(e){s=ne.get().createCanvas()}s.width=s.height=10,t.__canvas=s}return t.__canvas}static get _context(){return t.__context||(t.__context=t._canvas.getContext("2d",Ve)),t.__context}};Xe.METRICS_STRING="|q",Xe.BASELINE_SYMBOL="M",Xe.BASELINE_MULTIPLIER=1.4,Xe.HEIGHT_MULTIPLIER=2,Xe.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const t=new Intl.Segmenter;return e=>{const s=t.segment(e),i=[];let n=0;for(const t of s)i[n++]=t.segment;return i}}return t=>[...t]})(),Xe.experimentalLetterSpacing=!1,Xe._fonts={},Xe._newlines=[10,13],Xe._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],Xe._measurementCache=u(1e3);let Ye=Xe;class Ke{constructor(t=0,e=0,s=0){this.type="circle",this.x=t,this.y=e,this.radius=s}clone(){return new Ke(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let i=this.x-t,n=this.y-e;return i*=i,n*=n,i+n<=s}strokeContains(t,e,s,i=.5){if(0===this.radius)return!1;const n=this.x-t,r=this.y-e,a=this.radius,o=(1-i)*s,h=Math.sqrt(n*n+r*r);return h<=a+o&&h>a-(s-o)}getBounds(t){return t||(t=new St),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=2*this.radius,t.height=2*this.radius,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class qe{constructor(t=0,e=0,s=0,i=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=i}clone(){return new qe(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,i=(e-this.y)/this.halfHeight;return s*=s,i*=i,s+i<=1}strokeContains(t,e,s,i=.5){const{halfWidth:n,halfHeight:r}=this;if(n<=0||r<=0)return!1;const a=s*(1-i),o=s-a,h=n-o,l=r-o,c=n+a,d=r+a,u=t-this.x,p=e-this.y;return u*u/(h*h)+p*p/(l*l)>1&&u*u/(c*c)+p*p/(d*d)<=1}getBounds(t){return t||(t=new St),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=2*this.halfWidth,t.height=2*this.halfHeight,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Qe(t,e,s,i,n,r){const a=n-s,o=r-i,h=a*a+o*o;let l,c,d=-1;0!==h&&(d=((t-s)*a+(e-i)*o)/h),d<0?(l=s,c=i):d>1?(l=n,c=r):(l=s+d*a,c=i+d*o);const u=t-l,p=e-c;return u*u+p*p}class Ze{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let s=0,i=e.length;s<i;s++)t.push(e[s].x,e[s].y);e=t}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,s=e.length;for(let i=0;i<s;i+=2){const n=e[i],r=e[i+1];t+=(e[(i+2)%s]-n)*(e[(i+3)%s]+r)}return t<0}containsPolygon(t){const e=this.getBounds(undefined),s=t.getBounds(undefined);if(!e.containsRect(s))return!1;const i=t.points;for(let n=0;n<i.length;n+=2){const t=i[n],e=i[n+1];if(!this.contains(t,e))return!1}return!0}clone(){const t=this.points.slice(),e=new Ze(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const i=this.points.length/2;for(let n=0,r=i-1;n<i;r=n++){const i=this.points[2*n],a=this.points[2*n+1],o=this.points[2*r],h=this.points[2*r+1];a>e!=h>e&&t<(e-a)/(h-a)*(o-i)+i&&(s=!s)}return s}strokeContains(t,e,s,i=.5){const n=s*s,r=n*(1-i),a=n-r,{points:o}=this,h=o.length-(this.closePath?0:2);for(let l=0;l<h;l+=2){const s=o[l],i=o[l+1],n=o[(l+2)%o.length],h=o[(l+3)%o.length];if(Qe(t,e,s,i,n,h)<=(Math.sign((n-s)*(e-i)-(h-i)*(t-s))<0?a:r))return!0}return!1}getBounds(t){t||(t=new St);const e=this.points;let s=1/0,i=-1/0,n=1/0,r=-1/0;for(let a=0,o=e.length;a<o;a+=2){const t=e[a],o=e[a+1];s=t<s?t:s,i=t>i?t:i,n=o<n?o:n,r=o>r?o:r}return t.x=s,t.width=i-s,t.y=n,t.height=r-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return Ft(0,"Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return Ft(0,"Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const Je=(t,e,s,i,n,r,a)=>{const o=t-s,h=e-i,l=Math.sqrt(o*o+h*h);return l>=n-r&&l<=n+a};class ts{constructor(t=0,e=0,s=0,i=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=s,this.height=i,this.radius=n}getBounds(t){return t||(t=new St),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new ts(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let i=t-(this.x+s),n=e-(this.y+s);const r=s*s;if(i*i+n*n<=r)return!0;if(i=t-(this.x+this.width-s),i*i+n*n<=r)return!0;if(n=e-(this.y+this.height-s),i*i+n*n<=r)return!0;if(i=t-(this.x+s),i*i+n*n<=r)return!0}return!1}strokeContains(t,e,s,i=.5){const{x:n,y:r,width:a,height:o,radius:h}=this,l=s*(1-i),c=s-l,d=n+h,u=r+h,p=n+a,f=r+o;return(t>=n-l&&t<=n+c||t>=p-c&&t<=p+l)&&e>=u&&e<=u+(o-2*h)||((e>=r-l&&e<=r+c||e>=f-c&&e<=f+l)&&t>=d&&t<=d+(a-2*h)||(t<d&&e<u&&Je(t,e,d,u,h,c,l)||t>p-h&&e<u&&Je(t,e,p-h,u,h,c,l)||t>p-h&&e>f-h&&Je(t,e,p-h,f-h,h,c,l)||t<d&&e>f-h&&Je(t,e,d,f-h,h,c,l)))}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const es={};function ss(t,e,s){let i=2166136261;for(let n=0;n<e;n++)i^=t[n].uid,i=Math.imul(i,16777619),i>>>=0;return es[i]||function(t,e,s,i){const n={};let r=0;for(let o=0;o<i;o++){const s=o<e?t[o]:v.EMPTY.source;n[r++]=s.source,n[r++]=s.style}const a=new x(n);return es[s]=a,a}(t,e,i,s)}class is{constructor(t){"number"==typeof t?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}const ns=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function rs(t){let e="";for(let s=0;s<t;++s)s>0&&(e+="\nelse "),s<t-1&&(e+=`if(test == ${s}.0){}`);return e}function as(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const s=e.createShader(e.FRAGMENT_SHADER);try{for(;;){const i=ns.replace(/%forloop%/gi,rs(t));if(e.shaderSource(s,i),e.compileShader(s),e.getShaderParameter(s,e.COMPILE_STATUS))break;t=t/2|0}}finally{e.deleteShader(s)}return t}let os=null;class hs{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class ls{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new hs,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const cs=[];let ds=0;function us(){return ds>0?cs[--ds]:new ls}function ps(t){cs[ds++]=t}Nt.register({clear:()=>{if(cs.length>0)for(const t of cs)t&&t.destroy();cs.length=0,ds=0}});let fs=0;const ms=class t{constructor(e){this.uid=kt("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],(e={...t.defaultOptions,...e}).maxTextures||(Ft(0,"maxTextures is a required option for Batcher now, please pass it in the options"),e.maxTextures=function(){if(os)return os;const t=b();return os=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),os=as(os,t),t.getExtension("WEBGL_lose_context")?.loseContext(),os}());const{maxTextures:s,attributesInitialSize:i,indicesInitialSize:n}=e;this.attributeBuffer=new is(4*i),this.indexBuffer=new Uint16Array(n),this.maxTextures=s}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)ps(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const s=t._batch.textures.ids[e._source.uid];return!(!s&&0!==s)&&(t._textureId=s,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let s=us(),i=s.textures;i.clear();const n=e[this.elementStart];let r=A(n.blendMode,n.texture._source),a=n.topology;4*this.attributeSize>this.attributeBuffer.size&&this._resizeAttributeBuffer(4*this.attributeSize),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const o=this.attributeBuffer.float32View,h=this.attributeBuffer.uint32View,l=this.indexBuffer;let c=this._batchIndexSize,d=this._batchIndexStart,u="startBatch";const p=this.maxTextures;for(let f=this.elementStart;f<this.elementSize;++f){const n=e[f];e[f]=null;const m=n.texture._source,g=A(n.blendMode,m),_=r!==g||a!==n.topology;m._batchTick!==fs||_?(m._batchTick=fs,(i.count>=p||_)&&(this._finishBatch(s,d,c-d,i,r,a,t,u),u="renderBatch",d=c,r=g,a=n.topology,s=us(),i=s.textures,i.clear(),++fs),n._textureId=m._textureBindLocation=i.count,i.ids[m.uid]=i.count,i.textures[i.count++]=m,n._batch=s,c+=n.indexSize,n.packAsQuad?(this.packQuadAttributes(n,o,h,n._attributeStart,n._textureId),this.packQuadIndex(l,n._indexStart,n._attributeStart/this.vertexSize)):(this.packAttributes(n,o,h,n._attributeStart,n._textureId),this.packIndex(n,l,n._indexStart,n._attributeStart/this.vertexSize))):(n._textureId=m._textureBindLocation,c+=n.indexSize,n.packAsQuad?(this.packQuadAttributes(n,o,h,n._attributeStart,n._textureId),this.packQuadIndex(l,n._indexStart,n._attributeStart/this.vertexSize)):(this.packAttributes(n,o,h,n._attributeStart,n._textureId),this.packIndex(n,l,n._indexStart,n._attributeStart/this.vertexSize)),n._batch=s)}i.count>0&&(this._finishBatch(s,d,c-d,i,r,a,t,u),d=c,++fs),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=c}_finishBatch(t,e,s,i,n,r,a,o){t.gpuBindGroup=null,t.bindGroup=null,t.action=o,t.batcher=this,t.textures=i,t.blendMode=n,t.topology=r,t.start=e,t.size=s,++fs,this.batches[this.batchIndex++]=t,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){4*t<=this.attributeBuffer.size||this._resizeAttributeBuffer(4*t)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,2*this.attributeBuffer.size),s=new is(e);w(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(t){const e=this.indexBuffer;let s=Math.max(t,1.5*e.length);s+=s%2;const i=s>65535?new Uint32Array(s):new Uint16Array(s);if(i.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let n=0;n<e.length;n++)i[n]=e[n];else w(e.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(t,e,s){t[e]=s+0,t[e+1]=s+1,t[e+2]=s+2,t[e+3]=s+0,t[e+4]=s+2,t[e+5]=s+3}packIndex(t,e,s,i){const n=t.indices,r=t.indexSize,a=t.indexOffset,o=t.attributeOffset;for(let h=0;h<r;h++)e[s++]=i+n[h+a]-o}destroy(){if(null!==this.batches){for(let t=0;t<this.batches.length;t++)ps(this.batches[t]);this.batches=null;for(let t=0;t<this._elements.length;t++)this._elements[t]&&(this._elements[t]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};ms.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let gs=ms;const _s=new Float32Array(1),ys=new Uint32Array(1);class vs extends T{constructor(){const t=new E({data:_s,label:"attribute-batch-buffer",usage:P.VERTEX|P.COPY_DST,shrinkToFit:!1});super({attributes:{aPosition:{buffer:t,format:"float32x2",stride:24,offset:0},aUV:{buffer:t,format:"float32x2",stride:24,offset:8},aColor:{buffer:t,format:"unorm8x4",stride:24,offset:16},aTextureIdAndRound:{buffer:t,format:"uint16x2",stride:24,offset:20}},indexBuffer:new E({data:ys,label:"index-batch-buffer",usage:P.INDEX|P.COPY_DST,shrinkToFit:!1})})}}function xs(t,e,s){if(t)for(const i in t){const n=e[i.toLocaleLowerCase()];if(n){let e=t[i];"header"===i&&(e=e.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),s&&n.push(`//----${s}----//`),n.push(e)}else jt()}}const bs=/\{\{(.*?)\}\}/g;function As(t){const e={};return(t.match(bs)?.map(t=>t.replace(/[{()}]/g,""))??[]).forEach(t=>{e[t]=[]}),e}function ws(t,e){let s;const i=/@in\s+([^;]+);/g;for(;null!==(s=i.exec(t));)e.push(s[1])}function Ts(t,e,s=!1){const i=[];ws(e,i),t.forEach(t=>{t.header&&ws(t.header,i)});const n=i;s&&n.sort();const r=n.map((t,e)=>`       @location(${e}) ${t},`).join("\n");let a=e.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`\n${r}\n`),a}function Es(t,e){let s;const i=/@out\s+([^;]+);/g;for(;null!==(s=i.exec(t));)e.push(s[1])}function Ps(t,e){let s=t;for(const i in e){const t=e[i];s=t.join("\n").length?s.replace(`{{${i}}}`,`//-----${i} START-----//\n${t.join("\n")}\n//----${i} FINISH----//`):s.replace(`{{${i}}}`,"")}return s}const Ss=Object.create(null),Ms=new Map;let ks=0;function Cs({template:t,bits:e}){const s=Is(t,e);if(Ss[s])return Ss[s];const{vertex:i,fragment:n}=function(t,e){const s=e.map(t=>t.vertex).filter(t=>!!t),i=e.map(t=>t.fragment).filter(t=>!!t);let n=Ts(s,t.vertex,!0);n=function(t,e){const s=[];Es(e,s),t.forEach(t=>{t.header&&Es(t.header,s)});let i=0;const n=s.sort().map(t=>t.indexOf("builtin")>-1?t:`@location(${i++}) ${t}`).join(",\n"),r=s.sort().map(t=>{return`       var ${e=t,e.replace(/@.*?\s+/g,"")};`;var e}).join("\n"),a=`return VSOutput(\n            ${s.sort().map(t=>` ${function(t){const e=/\b(\w+)\s*:/g.exec(t);return e?e[1]:""}(t)}`).join(",\n")});`;let o=e.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`\n${n}\n`),o=o.replace("{{start}}",`\n${r}\n`),o=o.replace("{{return}}",`\n${a}\n`),o}(s,n);const r=Ts(i,t.fragment,!0);return{vertex:n,fragment:r}}(t,e);return Ss[s]=Os(i,n,e),Ss[s]}function Bs({template:t,bits:e}){const s=Is(t,e);return Ss[s]||(Ss[s]=Os(t.vertex,t.fragment,e)),Ss[s]}function Is(t,e){return e.map(t=>(Ms.has(t)||Ms.set(t,ks++),Ms.get(t))).sort((t,e)=>t-e).join("-")+t.vertex+t.fragment}function Os(t,e,s){const i=As(t),n=As(e);return s.forEach(t=>{xs(t.vertex,i,t.name),xs(t.fragment,n,t.name)}),{vertex:Ps(t,i),fragment:Ps(e,n)}}const Fs={name:"global-uniforms-bit",vertex:{header:"\n        struct GlobalUniforms {\n            uProjectionMatrix:mat3x3<f32>,\n            uWorldTransformMatrix:mat3x3<f32>,\n            uWorldColorAlpha: vec4<f32>,\n            uResolution: vec2<f32>,\n        }\n\n        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;\n        "}},Rs={name:"global-uniforms-bit",vertex:{header:"\n          uniform mat3 uProjectionMatrix;\n          uniform mat3 uWorldTransformMatrix;\n          uniform vec4 uWorldColorAlpha;\n          uniform vec2 uResolution;\n        "}};function Ls({bits:t,name:e}){const s=Cs({template:{fragment:"\n    @in vUV : vec2<f32>;\n    @in vColor : vec4<f32>;\n\n    {{header}}\n\n    @fragment\n    fn main(\n        {{in}}\n      ) -> @location(0) vec4<f32> {\n\n        {{start}}\n\n        var outColor:vec4<f32>;\n\n        {{main}}\n\n        var finalColor:vec4<f32> = outColor * vColor;\n\n        {{end}}\n\n        return finalColor;\n      };\n",vertex:"\n    @in aPosition: vec2<f32>;\n    @in aUV: vec2<f32>;\n\n    @out @builtin(position) vPosition: vec4<f32>;\n    @out vUV : vec2<f32>;\n    @out vColor : vec4<f32>;\n\n    {{header}}\n\n    struct VSOutput {\n        {{struct}}\n    };\n\n    @vertex\n    fn main( {{in}} ) -> VSOutput {\n\n        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;\n        var modelMatrix = mat3x3<f32>(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        var position = aPosition;\n        var uv = aUV;\n\n        {{start}}\n\n        vColor = vec4<f32>(1., 1., 1., 1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= globalUniforms.uWorldColorAlpha;\n\n        {{end}}\n\n        {{return}}\n    };\n"},bits:[Fs,...t]});return M.from({name:e,vertex:{source:s.vertex,entryPoint:"main"},fragment:{source:s.fragment,entryPoint:"main"}})}function Ds({bits:t,name:e}){return new S({name:e,...Bs({template:{vertex:"\n    in vec2 aPosition;\n    in vec2 aUV;\n\n    out vec4 vColor;\n    out vec2 vUV;\n\n    {{header}}\n\n    void main(void){\n\n        mat3 worldTransformMatrix = uWorldTransformMatrix;\n        mat3 modelMatrix = mat3(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        vec2 position = aPosition;\n        vec2 uv = aUV;\n\n        {{start}}\n\n        vColor = vec4(1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= uWorldColorAlpha;\n\n        {{end}}\n    }\n",fragment:"\n\n    in vec4 vColor;\n    in vec2 vUV;\n\n    out vec4 finalColor;\n\n    {{header}}\n\n    void main(void) {\n\n        {{start}}\n\n        vec4 outColor;\n\n        {{main}}\n\n        finalColor = outColor * vColor;\n\n        {{end}}\n    }\n"},bits:[Rs,...t]})})}const Us={name:"color-bit",vertex:{header:"\n            @in aColor: vec4<f32>;\n        ",main:"\n            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);\n        "}},zs={name:"color-bit",vertex:{header:"\n            in vec4 aColor;\n        ",main:"\n            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);\n        "}},Ws={};function $s(t){const e=[];if(1===t)e.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),e.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let s=0;for(let i=0;i<t;i++)e.push(`@group(1) @binding(${s++}) var textureSource${i+1}: texture_2d<f32>;`),e.push(`@group(1) @binding(${s++}) var textureSampler${i+1}: sampler;`)}return e.join("\n")}function Gs(t){const e=[];if(1===t)e.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{e.push("switch vTextureId {");for(let s=0;s<t;s++)s===t-1?e.push("  default:{"):e.push(`  case ${s}:{`),e.push(`      outColor = textureSampleGrad(textureSource${s+1}, textureSampler${s+1}, vUV, uvDx, uvDy);`),e.push("      break;}");e.push("}")}return e.join("\n")}function js(t){return Ws[t]||(Ws[t]={name:"texture-batch-bit",vertex:{header:"\n                @in aTextureIdAndRound: vec2<u32>;\n                @out @interpolate(flat) vTextureId : u32;\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1)\n                {\n                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n                }\n            "},fragment:{header:`\n                @in @interpolate(flat) vTextureId: u32;\n\n                ${$s(t)}\n            `,main:`\n                var uvDx = dpdx(vUV);\n                var uvDy = dpdy(vUV);\n\n                ${Gs(t)}\n            `}}),Ws[t]}const Ns={};function Hs(t){const e=[];for(let s=0;s<t;s++)s>0&&e.push("else"),s<t-1&&e.push(`if(vTextureId < ${s}.5)`),e.push("{"),e.push(`\toutColor = texture(uTextures[${s}], vUV);`),e.push("}");return e.join("\n")}function Vs(t){return Ns[t]||(Ns[t]={name:"texture-batch-bit",vertex:{header:"\n                in vec2 aTextureIdAndRound;\n                out float vTextureId;\n\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1.)\n                {\n                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n                }\n            "},fragment:{header:`\n                in float vTextureId;\n\n                uniform sampler2D uTextures[${t}];\n\n            `,main:`\n\n                ${Hs(t)}\n            `}}),Ns[t]}const Xs={name:"round-pixels-bit",vertex:{header:"\n            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>\n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}},Ys={name:"round-pixels-bit",vertex:{header:"\n            vec2 roundPixels(vec2 position, vec2 targetSize)\n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}};class Ks extends k{constructor(t){super({glProgram:Ds({name:"batch",bits:[zs,Vs(t),Ys]}),gpuProgram:Ls({name:"batch",bits:[Us,js(t),Xs]}),resources:{batchSamplers:C(t)}})}}let qs=null;const Qs=class t extends gs{constructor(e){super(e),this.geometry=new vs,this.name=t.extension.name,this.vertexSize=6,qs??(qs=new Ks(e.maxTextures)),this.shader=qs}packAttributes(t,e,s,i,n){const r=n<<16|65535&t.roundPixels,a=t.transform,o=a.a,h=a.b,l=a.c,c=a.d,d=a.tx,u=a.ty,{positions:p,uvs:f}=t,m=t.color,g=t.attributeOffset,_=g+t.attributeSize;for(let y=g;y<_;y++){const t=2*y,n=p[t],a=p[t+1];e[i++]=o*n+l*a+d,e[i++]=c*a+h*n+u,e[i++]=f[t],e[i++]=f[t+1],s[i++]=m,s[i++]=r}}packQuadAttributes(t,e,s,i,n){const r=t.texture,a=t.transform,o=a.a,h=a.b,l=a.c,c=a.d,d=a.tx,u=a.ty,p=t.bounds,f=p.maxX,m=p.minX,g=p.maxY,_=p.minY,y=r.uvs,v=t.color,x=n<<16|65535&t.roundPixels;e[i+0]=o*m+l*_+d,e[i+1]=c*_+h*m+u,e[i+2]=y.x0,e[i+3]=y.y0,s[i+4]=v,s[i+5]=x,e[i+6]=o*f+l*_+d,e[i+7]=c*_+h*f+u,e[i+8]=y.x1,e[i+9]=y.y1,s[i+10]=v,s[i+11]=x,e[i+12]=o*f+l*g+d,e[i+13]=c*g+h*f+u,e[i+14]=y.x2,e[i+15]=y.y2,s[i+16]=v,s[i+17]=x,e[i+18]=o*m+l*g+d,e[i+19]=c*g+h*m+u,e[i+20]=y.x3,e[i+21]=y.y3,s[i+22]=v,s[i+23]=x}};Qs.extension={type:[it.Batcher],name:"default"};let Zs=Qs;const Js=class t extends d{constructor(e={}){super(),this.uid=kt("textStyle"),this._tick=0,function(t){const e=t;if("boolean"==typeof e.dropShadow&&e.dropShadow){const s=ti.defaultDropShadow;t.dropShadow={alpha:e.dropShadowAlpha??s.alpha,angle:e.dropShadowAngle??s.angle,blur:e.dropShadowBlur??s.blur,color:e.dropShadowColor??s.color,distance:e.dropShadowDistance??s.distance}}if(void 0!==e.strokeThickness){Ft(0,"strokeThickness is now a part of stroke");const s=e.stroke;let i={};if(Wt.isColorLike(s))i.color=s;else if(s instanceof Q||s instanceof Z)i.fill=s;else{if(!Object.hasOwnProperty.call(s,"color")&&!Object.hasOwnProperty.call(s,"fill"))throw new Error("Invalid stroke value.");i=s}t.stroke={...i,width:e.strokeThickness}}if(Array.isArray(e.fillGradientStops)){if(Ft(0,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(e.fill)||0===e.fill.length)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");e.fill.length!==e.fillGradientStops.length&&jt();const s=new Q({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),i=e.fillGradientStops.slice(),n=e.fill.map(t=>Wt.shared.setValue(t).toNumber());i.forEach((t,e)=>{s.addColorStop(t,n[e])}),t.fill={fill:s}}}(e);const s={...t.defaultTextStyle,...e};for(const t in s){this[t]=s[t]}this.update(),this._tick=0}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.update())}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=null!==e&&"object"==typeof e?this._createProxy({...t.defaultDropShadow,...e}):e?this._createProxy({...t.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.update())}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(this._fontSize="string"==typeof t?parseInt(t,10):t,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.update())}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.update())}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.update())}get filters(){return this._filters}set filters(t){this._filters!==t&&(this._filters=Object.freeze(t),this.update())}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.update())}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...Y.defaultFillStyle,...t},()=>{this._fill=K({...this._originalFill},Y.defaultFillStyle)})),this._fill=K(0===t?"black":t,Y.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...Y.defaultStrokeStyle,...t},()=>{this._stroke=q({...this._originalStroke},Y.defaultStrokeStyle)})),this._stroke=q(t,Y.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const e=t.defaultTextStyle;for(const t in e)this[t]=e[t]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new t({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){this.removeAllListeners();if("boolean"==typeof t?t:t?.texture){const e="boolean"==typeof t?t:t?.textureSource;this._fill?.texture&&this._fill.texture.destroy(e),this._originalFill?.texture&&this._originalFill.texture.destroy(e),this._stroke?.texture&&this._stroke.texture.destroy(e),this._originalStroke?.texture&&this._originalStroke.texture.destroy(e)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(t,s,i)=>(t[s]===i||(t[s]=i,e?.(s,i),this.update()),!0)})}_isFillStyle(t){return null!==(t??null)&&!(Wt.isColorLike(t)||t instanceof Q||t instanceof Z)}};Js.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},Js.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let ti=Js;const ei=1e5;function si(t,e,s,i=0){if(t.texture===v.WHITE&&!t.fill)return Wt.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(!t.fill){const s=e.createPattern(t.texture.source.resource,"repeat"),i=t.matrix.copyTo(mt.shared);return i.scale(t.texture.frame.width,t.texture.frame.height),s.setTransform(i),s}if(t.fill instanceof Z){const s=t.fill,i=e.createPattern(s.texture.source.resource,"repeat"),n=s.transform.copyTo(mt.shared);return n.scale(s.texture.frame.width,s.texture.frame.height),i.setTransform(n),i}if(t.fill instanceof Q){const n=t.fill,r="linear"===n.type,a="local"===n.textureSpace;let o,h=1,l=1;a&&s&&(h=s.width+i,l=s.height+i);let c=!1;if(r){const{start:t,end:s}=n;o=e.createLinearGradient(t.x*h,t.y*l,s.x*h,s.y*l),c=Math.abs(s.x-t.x)<Math.abs(.1*(s.y-t.y))}else{const{center:t,innerRadius:s,outerCenter:i,outerRadius:r}=n;o=e.createRadialGradient(t.x*h,t.y*l,s*h,i.x*h,i.y*l,r*h)}if(c&&a&&s){const t=s.lineHeight/l;for(let e=0;e<s.lines.length;e++){const r=(e*s.lineHeight+i/2)/l;n.colorStops.forEach(e=>{const s=r+e.offset*t;o.addColorStop(Math.floor(s*ei)/ei,Wt.shared.setValue(e.color).toHex())})}}else n.colorStops.forEach(t=>{o.addColorStop(t.offset,Wt.shared.setValue(t.color).toHex())});return o}return jt(),"red"}const ii=class t extends je{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const s={...t.defaultOptions,...e};this._textureSize=s.textureSize,this._mipmap=s.mipmap;const i=s.style.clone();s.overrideFill&&(i._fill.color=16777215,i._fill.alpha=1,i._fill.texture=v.WHITE,i._fill.fill=null),this.applyFillAsTint=s.overrideFill;const n=i.fontSize;i.fontSize=this.baseMeasurementFontSize;const r=He(i);s.overrideSize?i._stroke&&(i._stroke.width*=this.baseRenderedFontSize/n):i.fontSize=this.baseRenderedFontSize=n,this._style=i,this._skipKerning=s.skipKerning??!1,this.resolution=s.resolution??1,this._padding=s.padding??4,s.textureStyle&&(this._textureStyle=s.textureStyle instanceof B?s.textureStyle:new B(s.textureStyle)),this.fontMetrics=Ye.measureFont(r),this.lineHeight=i.lineHeight||this.fontMetrics.fontSize||i.fontSize}ensureCharacters(t){const e=Ye.graphemeSegmenter(t).filter(t=>!this._currentChars.includes(t)).filter((t,e,s)=>s.indexOf(t)===e);if(!e.length)return;let s;this._currentChars=[...this._currentChars,...e],s=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex];let{canvas:i,context:n}=s.canvasAndContext,r=s.texture.source;const a=this._style;let o=this._currentX,h=this._currentY,l=this._currentMaxCharHeight;const c=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*c;let u=!1;const p=i.width/this.resolution,f=i.height/this.resolution;for(let m=0;m<e.length;m++){const t=e[m],s=Ye.measureText(t,a,i,!1);s.lineHeight=s.height;const g=s.width*c,_=Math.ceil(("italic"===a.fontStyle?2:1)*g)+2*d,y=s.height*c+2*d;if(u=!1,"\n"!==t&&"\r"!==t&&"\t"!==t&&" "!==t&&(u=!0,l=Math.ceil(Math.max(y,l))),o+_>p&&(h+=l,l=y,o=0,h+l>f)){r.update();const t=this._nextPage();i=t.canvasAndContext.canvas,n=t.canvasAndContext.context,r=t.texture.source,o=0,h=0,l=0}const x=g/c-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[t]={id:t.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:x,kerning:{}},u){this._drawGlyph(n,s,o+d,h+d,c,a);const e=r.width*c,i=r.height*c,l=new St(o/e*r.width,h/i*r.height,_/e*r.width,y/i*r.height);this.chars[t].texture=new v({source:r,frame:l}),o+=Math.ceil(_)}}r.update(),this._currentX=o,this._currentY=h,this._currentMaxCharHeight=l,this._skipKerning&&this._applyKerning(e,n)}get pageTextures(){return Ft(0,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const s=this._measureCache;for(let i=0;i<t.length;i++){const n=t[i];for(let t=0;t<this._currentChars.length;t++){const i=this._currentChars[t];let r=s[n];r||(r=s[n]=e.measureText(n).width);let a=s[i];a||(a=s[i]=e.measureText(i).width);let o=e.measureText(n+i).width,h=o-(r+a);h&&(this.chars[n].kerning[i]=h),o=e.measureText(n+i).width,h=o-(r+a),h&&(this.chars[i].kerning[n]=h)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=I.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const s=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),i=new v({source:new f({resource:e.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(i.source.style=this._textureStyle);const n={canvasAndContext:e,texture:i};return this.pages[this._currentPageIndex]=n,n}_setupContext(t,e,s){e.fontSize=this.baseRenderedFontSize,t.scale(s,s),t.font=He(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const i=e._stroke,n=i?.width??0;if(i&&(t.lineWidth=n,t.lineJoin=i.join,t.miterLimit=i.miterLimit,t.strokeStyle=si(i,t)),e._fill&&(t.fillStyle=si(e._fill,t)),e.dropShadow){const i=e.dropShadow,n=Wt.shared.setValue(i.color).toArray(),r=i.blur*s,a=i.distance*s;t.shadowColor=`rgba(${255*n[0]},${255*n[1]},${255*n[2]},${i.alpha})`,t.shadowBlur=r,t.shadowOffsetX=Math.cos(i.angle)*a,t.shadowOffsetY=Math.sin(i.angle)*a}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,s,i,n,r){const a=e.text,o=e.fontProperties,h=r._stroke,l=(h?.width??0)*n,c=s+l/2,d=i-l/2,u=o.descent*n,p=e.lineHeight*n;let f=!1;r.stroke&&l&&(f=!0,t.strokeText(a,c,d+p-u));const{shadowBlur:m,shadowOffsetX:g,shadowOffsetY:_}=t;r._fill&&(f&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.fillText(a,c,d+p-u)),f&&(t.shadowBlur=m,t.shadowOffsetX=g,t.shadowOffsetY=_)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:s}=this.pages[t];I.returnCanvasAndContext(e),s.destroy(!0)}this.pages=null}};ii.defaultOptions={textureSize:512,style:new ti,mipmap:!0};let ni=ii;function ri(t,e,s,i){const n={width:0,height:0,offsetY:0,scale:e.fontSize/s.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};n.offsetY=s.baseLineOffset;let r=n.lines[0],a=null,o=!0;const h={width:0,start:0,index:0,positions:[],chars:[]},l=s.baseMeasurementFontSize/e.fontSize,c=e.letterSpacing*l,d=e.wordWrapWidth*l,u=e.lineHeight?e.lineHeight*l:s.lineHeight,p=e.wordWrap&&e.breakWords,f=t=>{const e=r.width;for(let s=0;s<h.index;s++){const i=t.positions[s];r.chars.push(t.chars[s]),r.charPositions.push(i+e)}r.width+=t.width,o=!1,h.width=0,h.index=0,h.chars.length=0},m=()=>{let t=r.chars.length-1;if(i){let e=r.chars[t];for(;" "===e;)r.width-=s.chars[e].xAdvance,e=r.chars[--t]}n.width=Math.max(n.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,n.lines.push(r),n.height+=u},g=t=>t-c>d;for(let _=0;_<t.length+1;_++){let i;const n=_===t.length;n||(i=t[_]);const l=s.chars[i]||s.chars[" "];if(/(?:\s)/.test(i)||"\r"===i||"\n"===i||n){if(!o&&e.wordWrap&&g(r.width+h.width)?(m(),f(h),n||r.charPositions.push(0)):(h.start=r.width,f(h),n||r.charPositions.push(0)),"\r"===i||"\n"===i)m();else if(!n){const t=l.xAdvance+(l.kerning[a]||0)+c;r.width+=t,r.spaceWidth=t,r.spacesIndex.push(r.charPositions.length),r.chars.push(i)}}else{const t=l.kerning[a]||0,e=l.xAdvance+t+c;p&&g(r.width+h.width+e)&&(f(h),m()),h.positions[h.index++]=h.width+t,h.chars.push(i),h.width+=e}a=i}return m(),"center"===e.align?function(t){for(let e=0;e<t.lines.length;e++){const s=t.lines[e],i=t.width/2-s.width/2;for(let t=0;t<s.charPositions.length;t++)s.charPositions[t]+=i}}(n):"right"===e.align?function(t){for(let e=0;e<t.lines.length;e++){const s=t.lines[e],i=t.width-s.width;for(let t=0;t<s.charPositions.length;t++)s.charPositions[t]+=i}}(n):"justify"===e.align&&function(t){const e=t.width;for(let s=0;s<t.lines.length;s++){const i=t.lines[s];let n=0,r=i.spacesIndex[n++],a=0;const o=i.spacesIndex.length,h=(e-i.width)/o;for(let t=0;t<i.charPositions.length;t++)t===r&&(r=i.spacesIndex[n++],a+=h),i.charPositions[t]+=a}}(n),n}let ai=0;const oi=new class{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=u(1e3)}getFont(t,e){let s=`${e.fontFamily}-bitmap`,i=!0;if(e._fill.fill&&!e._stroke?(s+=e._fill.fill.styleKey,i=!1):(e._stroke||e.dropShadow)&&(s=`${e.styleKey}-bitmap`,i=!1),!ue.has(s)){const t=Object.create(e);t.lineHeight=0;const n=new ni({style:t,overrideFill:i,overrideSize:!0,...this.defaultOptions});ai++,ai>50&&jt(),n.once("destroy",()=>{ai--,ue.remove(s)}),ue.set(s,n)}const n=ue.get(s);return n.ensureCharacters?.(t),n}getLayout(t,e,s=!0){const i=this.getFont(t,e),n=`${t}-${e.styleKey}-${s}`;if(this.measureCache.has(n))return this.measureCache.get(n);const r=ri(Ye.graphemeSegmenter(t),e,i,s);return this.measureCache.set(n,r),r}measureText(t,e,s=!0){return this.getLayout(t,e,s)}install(...t){let e=t[0];"string"==typeof e&&(e={name:e,style:t[1],chars:t[2]?.chars,resolution:t[2]?.resolution,padding:t[2]?.padding,skipKerning:t[2]?.skipKerning},Ft(0,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=e?.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const i=e.style,n=i instanceof ti?i:new ti(i),r=e.dynamicFill??this._canUseTintForStyle(n),a=new ni({style:n,overrideFill:r,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),o=function(t){if(""===t)return[];"string"==typeof t&&(t=[t]);const e=[];for(let s=0,i=t.length;s<i;s++){const i=t[s];if(Array.isArray(i)){if(2!==i.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${i.length}.`);if(0===i[0].length||0===i[1].length)throw new Error("[BitmapFont]: Invalid character delimiter.");const t=i[0].charCodeAt(0),s=i[1].charCodeAt(0);if(s<t)throw new Error("[BitmapFont]: Invalid character range.");for(let i=t,n=s;i<=n;i++)e.push(String.fromCharCode(i))}else e.push(...Array.from(i))}if(0===e.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return e}(e.chars);return a.ensureCharacters(o.join("")),ue.set(`${s}-bitmap`,a),a.once("destroy",()=>ue.remove(`${s}-bitmap`)),a}uninstall(t){const e=`${t}-bitmap`,s=ue.get(e);s&&s.destroy()}_canUseTintForStyle(t){return!(t._stroke||t.dropShadow&&0!==t.dropShadow.color||t._fill.fill||16777215!==t._fill.color)}};class hi extends je{constructor(t,e){super();const{textures:s,data:i}=t;Object.keys(i.pages).forEach(t=>{const e=i.pages[parseInt(t,10)],n=s[e.id];this.pages.push({texture:n})}),Object.keys(i.chars).forEach(t=>{const e=i.chars[t],{frame:n,source:r,rotate:a}=s[e.page],o=Et.transformRectCoords(e,n,a,new St),h=new v({frame:o,orig:new St(0,0,e.width,e.height),source:r,rotate:a});this.chars[t]={id:t.codePointAt(0),xOffset:e.xOffset,yOffset:e.yOffset,xAdvance:e.xAdvance,kerning:e.kerning??{},texture:h}}),this.baseRenderedFontSize=i.fontSize,this.baseMeasurementFontSize=i.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:i.fontSize},this.baseLineOffset=i.baseLineOffset,this.lineHeight=i.lineHeight,this.fontFamily=i.fontFamily,this.distanceField=i.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){oi.install(t)}static uninstall(t){oi.uninstall(t)}}const li={test:t=>"string"==typeof t&&t.startsWith("info face="),parse(t){const e=t.match(/^[a-z]+\s+.+$/gm),s={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const d in e){const t=e[d].match(/^[a-z]+/gm)[0],i=e[d].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),n={};for(const e in i){const t=i[e].split("="),s=t[0],r=t[1].replace(/"/gm,""),a=parseFloat(r),o=isNaN(a)?r:a;n[s]=o}s[t].push(n)}const i={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[n]=s.info,[r]=s.common,[a]=s.distanceField??[];a&&(i.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),i.fontSize=parseInt(n.size,10),i.fontFamily=n.face,i.lineHeight=parseInt(r.lineHeight,10);const o=s.page;for(let d=0;d<o.length;d++)i.pages.push({id:parseInt(o[d].id,10)||0,file:o[d].file});const h={};i.baseLineOffset=i.lineHeight-parseInt(r.base,10);const l=s.char;for(let d=0;d<l.length;d++){const t=l[d],e=parseInt(t.id,10);let s=t.letter??t.char??String.fromCharCode(e);"space"===s&&(s=" "),h[e]=s,i.chars[s]={id:e,page:parseInt(t.page,10)||0,x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xOffset:parseInt(t.xoffset,10),yOffset:parseInt(t.yoffset,10),xAdvance:parseInt(t.xadvance,10),kerning:{}}}const c=s.kerning||[];for(let d=0;d<c.length;d++){const t=parseInt(c[d].first,10),e=parseInt(c[d].second,10),s=parseInt(c[d].amount,10);i.chars[h[e]].kerning[h[t]]=s}return i}},ci={test(t){const e=t;return"string"!=typeof e&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")},parse(t){const e={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},s=t.getElementsByTagName("info")[0],i=t.getElementsByTagName("common")[0],n=t.getElementsByTagName("distanceField")[0];n&&(e.distanceField={type:n.getAttribute("fieldType"),range:parseInt(n.getAttribute("distanceRange"),10)});const r=t.getElementsByTagName("page"),a=t.getElementsByTagName("char"),o=t.getElementsByTagName("kerning");e.fontSize=parseInt(s.getAttribute("size"),10),e.fontFamily=s.getAttribute("face"),e.lineHeight=parseInt(i.getAttribute("lineHeight"),10);for(let l=0;l<r.length;l++)e.pages.push({id:parseInt(r[l].getAttribute("id"),10)||0,file:r[l].getAttribute("file")});const h={};e.baseLineOffset=e.lineHeight-parseInt(i.getAttribute("base"),10);for(let l=0;l<a.length;l++){const t=a[l],s=parseInt(t.getAttribute("id"),10);let i=t.getAttribute("letter")??t.getAttribute("char")??String.fromCharCode(s);"space"===i&&(i=" "),h[s]=i,e.chars[i]={id:s,page:parseInt(t.getAttribute("page"),10)||0,x:parseInt(t.getAttribute("x"),10),y:parseInt(t.getAttribute("y"),10),width:parseInt(t.getAttribute("width"),10),height:parseInt(t.getAttribute("height"),10),xOffset:parseInt(t.getAttribute("xoffset"),10),yOffset:parseInt(t.getAttribute("yoffset"),10),xAdvance:parseInt(t.getAttribute("xadvance"),10),kerning:{}}}for(let l=0;l<o.length;l++){const t=parseInt(o[l].getAttribute("first"),10),s=parseInt(o[l].getAttribute("second"),10),i=parseInt(o[l].getAttribute("amount"),10);e.chars[h[s]].kerning[h[t]]=i}return e}},di={test:t=>!("string"!=typeof t||!t.includes("<font>"))&&ci.test(ne.get().parseXML(t)),parse:t=>ci.parse(ne.get().parseXML(t))},ui=[".xml",".fnt"],pi={extension:{type:it.CacheParser,name:"cacheBitmapFont"},test:t=>t instanceof hi,getCacheableAssets(t,e){const s={};return t.forEach(t=>{s[t]=e,s[`${t}-bitmap`]=e}),s[`${e.fontFamily}-bitmap`]=e,s}},fi={extension:{type:it.LoadParser,priority:pe.Normal},name:"loadBitmapFont",id:"bitmap-font",test:t=>ui.includes(ge.extname(t).toLowerCase()),testParse:async t=>li.test(t)||di.test(t),async parse(t,e,s){const i=li.test(t)?li.parse(t):di.parse(t),{src:n}=e,{pages:r}=i,a=[],o=i.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let c=0;c<r.length;++c){const t=r[c].file;let e=ge.join(ge.dirname(n),t);e=be(e,n),a.push({src:e,data:o})}const h=await s.load(a),l=a.map(t=>h[t.src]);return new hi({data:i,textures:l},n)},async load(t,e){const s=await ne.get().fetch(t);return await s.text()},async unload(t,e,s){await Promise.all(t.pages.map(t=>s.unload(t.texture.source._sourceOrigin))),t.destroy()}};class mi{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(t=>{this._assetList.push(t)}),this.verbose,this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const gi={extension:{type:it.CacheParser,name:"cacheTextureArray"},test:t=>Array.isArray(t)&&t.every(t=>t instanceof v),getCacheableAssets:(t,e)=>{const s={};return t.forEach(t=>{e.forEach((e,i)=>{s[t+(0===i?"":i+1)]=e})}),s}};async function _i(t){if("Image"in globalThis)return new Promise(e=>{const s=new Image;s.onload=()=>{e(!0)},s.onerror=()=>{e(!1)},s.src=t});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const e=await(await fetch(t)).blob();await createImageBitmap(e)}catch(e){return!1}return!0}return!1}const yi={extension:{type:it.DetectionParser,priority:1},test:async()=>_i("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async t=>[...t,"avif"],remove:async t=>t.filter(t=>"avif"!==t)},vi=["png","jpg","jpeg"],xi={extension:{type:it.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async t=>[...t,...vi],remove:async t=>t.filter(t=>!vi.includes(t))},bi="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Ai(t){if(bi)return!1;return""!==document.createElement("video").canPlayType(t)}const wi={extension:{type:it.DetectionParser,priority:0},test:async()=>Ai("video/mp4"),add:async t=>[...t,"mp4","m4v"],remove:async t=>t.filter(t=>"mp4"!==t&&"m4v"!==t)},Ti={extension:{type:it.DetectionParser,priority:0},test:async()=>Ai("video/ogg"),add:async t=>[...t,"ogv"],remove:async t=>t.filter(t=>"ogv"!==t)},Ei={extension:{type:it.DetectionParser,priority:0},test:async()=>Ai("video/webm"),add:async t=>[...t,"webm"],remove:async t=>t.filter(t=>"webm"!==t)},Pi={extension:{type:it.DetectionParser,priority:0},test:async()=>_i("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async t=>[...t,"webp"],remove:async t=>t.filter(t=>"webp"!==t)},Si=class t{constructor(){this.loadOptions={...t.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,s)=>(this._parsersValidated=!1,t[e]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{let i=null,n=null;if((e.parser||e.loadParser)&&(n=this._parserHash[e.parser||e.loadParser],e.loadParser&&jt(),n||jt(e.parser||e.loadParser)),!n){for(let s=0;s<this.parsers.length;s++){const i=this.parsers[s];if(i.load&&i.test?.(t,e,this)){n=i;break}}if(!n)return jt(),null}i=await n.load(t,e,this),s.parser=n;for(let t=0;t<this.parsers.length;t++){const n=this.parsers[t];n.parse&&n.parse&&await(n.testParse?.(i,e,this))&&(i=await n.parse(i,e,this)||i,s.parser=n)}return i})(),s}async load(e,s){this._parsersValidated||this._validateParsers();const i="function"==typeof s?{...t.defaultOptions,...this.loadOptions,onProgress:s}:{...t.defaultOptions,...this.loadOptions,...s||{}},{onProgress:n,onError:r,strategy:a,retryCount:o,retryDelay:h}=i;let l=0;const c={},d=ve(e),u=de(e,t=>({alias:[t],src:t,data:{}})),p=u.reduce((t,e)=>t+(e.progressSize||1),0),f=u.map(async t=>{const e=ge.toAbsolute(t.src);c[t.src]||(await this._loadAssetWithRetry(e,t,{onProgress:n,onError:r,strategy:a,retryCount:o,retryDelay:h},c),l+=t.progressSize||1,n&&n(l/p))});return await Promise.all(f),d?c[u[0].src]:c}async unload(t){const e=de(t,t=>({alias:[t],src:t})).map(async t=>{const e=ge.toAbsolute(t.src),s=this.promiseCache[e];if(s){const i=await s.promise;delete this.promiseCache[e],await(s.parser?.unload?.(i,t,this))}});await Promise.all(e)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name||t.id).reduce((t,e)=>(e.name||e.id?(t[e.name]||t[e.id])&&jt(e.id):jt(),t[e.name]=e,e.id&&(t[e.id]=e),t),{})}async _loadAssetWithRetry(t,e,s,i){let n=0;const{onError:r,strategy:a,retryCount:o,retryDelay:h}=s,l=t=>new Promise(e=>setTimeout(e,t));for(;;)try{return this.promiseCache[t]||(this.promiseCache[t]=this._getLoadPromiseAndParser(t,e)),void(i[e.src]=await this.promiseCache[t].promise)}catch(c){delete this.promiseCache[t],delete i[e.src],n++;if("retry"===a&&!("retry"!==a||n>o)){r&&r(c,e),await l(h);continue}if("skip"===a)return void(r&&r(c,e));throw r&&r(c,e),new Error(`[Loader.load] Failed to load ${t}.\n${c}`)}}};Si.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let Mi=Si;function ki(t,e){if(Array.isArray(e)){for(const s of e)if(t.startsWith(`data:${s}`))return!0;return!1}return t.startsWith(`data:${e}`)}function Ci(t,e){const s=t.split("?")[0],i=ge.extname(s).toLowerCase();return Array.isArray(e)?e.includes(i):i===e}const Bi={extension:{type:it.LoadParser,priority:pe.Low},name:"loadJson",id:"json",test:t=>ki(t,"application/json")||Ci(t,".json"),async load(t){const e=await ne.get().fetch(t);return await e.json()}},Ii={name:"loadTxt",id:"text",extension:{type:it.LoadParser,priority:pe.Low,name:"loadTxt"},test:t=>ki(t,"text/plain")||Ci(t,".txt"),async load(t){const e=await ne.get().fetch(t);return await e.text()}},Oi=["normal","bold","100","200","300","400","500","600","700","800","900"],Fi=[".ttf",".otf",".woff",".woff2"],Ri=["font/ttf","font/otf","font/woff","font/woff2"],Li=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;const Di=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function Ui(t){return Di.test(t)?t:encodeURI(t)}const zi={extension:{type:it.LoadParser,priority:pe.Low},name:"loadWebFont",id:"web-font",test:t=>ki(t,Ri)||Ci(t,Fi),async load(t,e){const s=ne.get().getFontFaceSet();if(s){const i=[],n=e.data?.family??function(t){const e=ge.extname(t),s=ge.basename(t,e).replace(/(-|_)/g," ").toLowerCase().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1));let i=s.length>0;for(const r of s)if(!r.match(Li)){i=!1;break}let n=s.join(" ");return i||(n=`"${n.replace(/[\\"]/g,"\\$&")}"`),n}(t),r=e.data?.weights?.filter(t=>Oi.includes(t))??["normal"],a=e.data??{};for(let e=0;e<r.length;e++){const o=r[e],h=new FontFace(n,`url(${Ui(t)})`,{...a,weight:o});await h.load(),s.add(h),i.push(h)}if(ue.has(`${n}-and-url`)){ue.get(`${n}-and-url`).entries.push({url:t,faces:i})}else ue.set(`${n}-and-url`,{entries:[{url:t,faces:i}]});return 1===i.length?i[0]:i}return jt(),null},unload(t){const e=Array.isArray(t)?t:[t],s=e[0].family,i=ue.get(`${s}-and-url`),n=i.entries.find(t=>t.faces.some(t=>-1!==e.indexOf(t)));n.faces=n.faces.filter(t=>-1===e.indexOf(t)),0===n.faces.length&&(i.entries=i.entries.filter(t=>t!==n)),e.forEach(t=>{ne.get().getFontFaceSet().delete(t)}),0===i.entries.length&&ue.remove(`${s}-and-url`)}};function Wi(t,e=1){const s=xe.RETINA_PREFIX?.exec(t);return s?parseFloat(s[1]):e}let $i=null,Gi=class{constructor(){$i||($i=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n    async function checkImageBitmap() {\n      try {\n        if (typeof createImageBitmap !== "function")\n          return false;\n        const response = await fetch(WHITE_PNG);\n        const imageBlob = await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\n      } catch (_e) {\n        return false;\n      }\n    }\n    void checkImageBitmap().then((result) => {\n      self.postMessage(result);\n    });\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker($i)}};Gi.revokeObjectURL=function(){$i&&(URL.revokeObjectURL($i),$i=null)};let ji=null;class Ni{constructor(){ji||(ji=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    async function loadImageBitmap(url, alphaMode) {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n      }\n      const imageBlob = await response.blob();\n      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);\n    }\n    self.onmessage = async (event) => {\n      try {\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\n        self.postMessage({\n          data: imageBitmap,\n          uuid: event.data.uuid,\n          id: event.data.id\n        }, [imageBitmap]);\n      } catch (e) {\n        self.postMessage({\n          error: e,\n          uuid: event.data.uuid,\n          id: event.data.id\n        });\n      }\n    };\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(ji)}}Ni.revokeObjectURL=function(){ji&&(URL.revokeObjectURL(ji),ji=null)};let Hi,Vi=0;const Xi=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Gi;e.addEventListener("message",s=>{e.terminate(),Gi.revokeObjectURL(),t(s.data)})})),this._isImageBitmapSupported}loadImageBitmap(t,e){return this._run("loadImageBitmap",[t,e?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){void 0===Hi&&(Hi=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<Hi&&(this._createdWorkers++,t=(new Ni).worker,t.addEventListener("message",t=>{this._complete(t.data),this._returnWorker(t.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){void 0!==t.error?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),this._resolveHash[t.uuid]=null}async _run(t,e){await this._initWorkers();const s=new Promise((s,i)=>{this._queue.push({id:t,arguments:e,resolve:s,reject:i})});return this._next(),s}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),s=e.id;this._resolveHash[Vi]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Vi++,id:s})}reset(){this._workerPool.forEach(t=>t.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:t})=>{t?.(new Error("WorkerManager destroyed"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}},Yi={extension:{type:it.ResolveParser,name:"resolveTexture"},test:z.test,parse:t=>({resolution:parseFloat(xe.RETINA_PREFIX.exec(t)?.[1]??"1"),format:t.split(".").pop(),src:t})},Ki={extension:{type:it.ResolveParser,priority:-2,name:"resolveJson"},test:t=>xe.RETINA_PREFIX.test(t)&&t.endsWith(".json"),parse:Yi.parse};const qi=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new xe,this.loader=new Mi,this.cache=ue,this._backgroundLoader=new mi(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized)return void jt();if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let e=t.manifest;"string"==typeof e&&(e=await this.load(e)),this.resolver.addManifest(e)}const e=t.texturePreference?.resolution??1,s="number"==typeof e?[e]:e,i=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:s}}),t.preferences&&this.setPreferences(t.preferences),t.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...t.loadOptions})}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const s=ve(t),i=de(t).map(t=>{if("string"!=typeof t){const e=this.resolver.getAlias(t);return e.some(t=>!this.resolver.hasKey(t))&&this.add(t),Array.isArray(e)?e[0]:e}return this.resolver.hasKey(t)||this.add({alias:t,src:t}),t}),n=this.resolver.resolve(i),r=await this._mapLoadToResolve(n,e);return s?r[i[0]]:r}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;"string"==typeof t&&(s=!0,t=[t]);const i=this.resolver.resolveBundle(t),n={},r=Object.keys(i);let a=0;const o=[],h=r.map((t,s)=>{const r=i[t],h=Object.values(r),l=[...new Set(h.flat())].reduce((t,e)=>t+(e.progressSize||1),0);return o.push(0),a+=l,this._mapLoadToResolve(r,t=>{o[s]=t*l,e?.(o.reduce((t,e)=>t+e,0)/a)}).then(e=>{n[t]=e})});return await Promise.all(h),s?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),"string"==typeof t&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(t=>{this._backgroundLoader.add(Object.values(t))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if("string"==typeof t)return ue.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=ue.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const i=await this.loader.load(s,e);this._backgroundLoader.active=!0;const n={};return s.forEach(t=>{const e=i[t.src],s=[t.src];t.alias&&s.push(...t.alias),s.forEach(t=>{n[t]=e}),ue.set(s,e)}),n}async unload(t){this._initialized||await this.init();const e=de(t).map(t=>"string"!=typeof t?t.src:t),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=de(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(t=>this._unloadFromResolved(e[t]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(t=>{ue.remove(t.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const s of t.detections)t.skipDetections||await s.test()?e=await s.add(e):t.skipDetections||(e=await s.remove(e));return e=e.filter((t,s)=>e.indexOf(t)===s),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(e=>e in t).forEach(s=>{e.config[s]=t[s]})})}};at.handleByList(it.LoadParser,qi.loader.parsers).handleByList(it.ResolveParser,qi.resolver.parsers).handleByList(it.CacheParser,qi.cache.parsers).handleByList(it.DetectionParser,qi.detections),at.add(gi,xi,yi,Pi,wi,Ti,Ei,Bi,Ii,zi,W,z,$,fi,pi,Yi,Ki);const Qi={loader:it.LoadParser,resolver:it.ResolveParser,cache:it.CacheParser,detection:it.DetectionParser};at.handle(it.Asset,t=>{const e=t.ref;Object.entries(Qi).filter(([t])=>!!e[t]).forEach(([t,s])=>at.add(Object.assign(e[t],{extension:e[t].extension??s})))},t=>{const e=t.ref;Object.keys(Qi).filter(t=>!!e[t]).forEach(t=>at.remove(e[t]))});class Zi{constructor(t){this._attachedDomElements=[],this._renderer=t,this._renderer.runners.postrender.add(this),this._renderer.runners.init.add(this),this._domElement=document.createElement("div"),this._domElement.style.position="absolute",this._domElement.style.top="0",this._domElement.style.left="0",this._domElement.style.pointerEvents="none",this._domElement.style.zIndex="1000"}init(){this._canvasObserver=new Ae({domElement:this._domElement,renderer:this._renderer})}addRenderable(t,e){this._attachedDomElements.includes(t)||this._attachedDomElements.push(t)}updateRenderable(t){}validateRenderable(t){return!0}postrender(){const t=this._attachedDomElements;if(0!==t.length){this._canvasObserver.ensureAttached();for(let e=0;e<t.length;e++){const s=t[e],i=s.element;if(!s.parent||s.globalDisplayStatus<7)i?.remove(),t.splice(e,1),e--;else{this._domElement.contains(i)||(i.style.position="absolute",i.style.pointerEvents="auto",this._domElement.appendChild(i));const t=s.worldTransform,e=s._anchor,n=s.width*e.x,r=s.height*e.y;i.style.transformOrigin=`${n}px ${r}px`,i.style.transform=`matrix(${t.a}, ${t.b}, ${t.c}, ${t.d}, ${t.tx-n}, ${t.ty-r})`,i.style.opacity=s.groupAlpha.toString()}}}else this._domElement.remove()}destroy(){this._renderer.runners.postrender.remove(this);for(let t=0;t<this._attachedDomElements.length;t++){const e=this._attachedDomElements[t];e.element?.remove()}this._attachedDomElements.length=0,this._domElement.remove(),this._canvasObserver.destroy(),this._renderer=null}}Zi.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"dom"};const Ji=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}init(t){this.removeTickerListener(),this.events=t,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(t){this._pauseUpdate=t}addTickerListener(){!this._tickerAdded&&this.domElement&&(le.system.add(this._tickerUpdate,this,re.INTERACTION),this._tickerAdded=!0)}removeTickerListener(){this._tickerAdded&&(le.system.remove(this._tickerUpdate,this),this._tickerAdded=!1)}pointerMoved(){this._didMove=!0}_update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const t=this.events._rootPointerEvent;this.events.supportsTouchEvents&&"touch"===t.pointerType||globalThis.document.dispatchEvent(this.events.supportsPointerEvents?new PointerEvent("pointermove",{clientX:t.clientX,clientY:t.clientY,pointerType:t.pointerType,pointerId:t.pointerId}):new MouseEvent("mousemove",{clientX:t.clientX,clientY:t.clientY}))}_tickerUpdate(t){this._deltaTime+=t.deltaTime,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this._update())}destroy(){this.removeTickerListener(),this.events=null,this.domElement=null,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}};class tn extends we{constructor(){super(...arguments),this.client=new pt,this.movement=new pt,this.offset=new pt,this.global=new pt,this.screen=new pt}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(t,e,s){return t.worldTransform.applyInverse(s||this.global,e)}getModifierState(t){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(t)}initMouseEvent(t,e,s,i,n,r,a,o,h,l,c,d,u,p,f){throw new Error("Method not implemented.")}}class en extends tn{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class sn extends tn{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}sn.DOM_DELTA_PIXEL=0,sn.DOM_DELTA_LINE=1,sn.DOM_DELTA_PAGE=2;const nn=new pt,rn=new pt;class an{constructor(t){this.dispatch=new d,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=t,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(t,e){this.mappingTable[t]||(this.mappingTable[t]=[]),this.mappingTable[t].push({fn:e,priority:0}),this.mappingTable[t].sort((t,e)=>t.priority-e.priority)}dispatchEvent(t,e){t.propagationStopped=!1,t.propagationImmediatelyStopped=!1,this.propagate(t,e),this.dispatch.emit(e||t.type,t)}mapEvent(t){if(!this.rootTarget)return;const e=this.mappingTable[t.type];if(e)for(let s=0,i=e.length;s<i;s++)e[s].fn(t);else jt(t.type)}hitTest(t,e){Ji.pauseUpdate=!0;const s=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,nn.set(t,e),this.hitTestFn,this.hitPruneFn);return s&&s[0]}propagate(t,e){if(!t.target)return;const s=t.composedPath();t.eventPhase=t.CAPTURING_PHASE;for(let i=0,n=s.length-1;i<n;i++)if(t.currentTarget=s[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return;if(t.eventPhase=t.AT_TARGET,t.currentTarget=t.target,this.notifyTarget(t,e),!t.propagationStopped&&!t.propagationImmediatelyStopped){t.eventPhase=t.BUBBLING_PHASE;for(let i=s.length-2;i>=0;i--)if(t.currentTarget=s[i],this.notifyTarget(t,e),t.propagationStopped||t.propagationImmediatelyStopped)return}}all(t,e,s=this._allInteractiveElements){if(0===s.length)return;t.eventPhase=t.BUBBLING_PHASE;const i=Array.isArray(e)?e:[e];for(let n=s.length-1;n>=0;n--)i.forEach(e=>{t.currentTarget=s[n],this.notifyTarget(t,e)})}propagationPath(t){const e=[t];for(let s=0;s<2048&&t!==this.rootTarget&&t.parent;s++){if(!t.parent)throw new Error("Cannot find propagation path to disconnected target");e.push(t.parent),t=t.parent}return e.reverse(),e}hitTestMoveRecursive(t,e,s,i,n,r=!1){let a=!1;if(this._interactivePrune(t))return null;if("dynamic"!==t.eventMode&&"dynamic"!==e||(Ji.pauseUpdate=!1),t.interactiveChildren&&t.children){const o=t.children;for(let h=o.length-1;h>=0;h--){const l=o[h],c=this.hitTestMoveRecursive(l,this._isInteractive(e)?e:l.eventMode,s,i,n,r||n(t,s));if(c){if(c.length>0&&!c[c.length-1].parent)continue;const e=t.isInteractive();(c.length>0||e)&&(e&&this._allInteractiveElements.push(t),c.push(t)),0===this._hitElements.length&&(this._hitElements=c),a=!0}}}const o=this._isInteractive(e),h=t.isInteractive();return h&&h&&this._allInteractiveElements.push(t),r||this._hitElements.length>0?null:a?this._hitElements:o&&!n(t,s)&&i(t,s)?h?[t]:[]:null}hitTestRecursive(t,e,s,i,n){if(this._interactivePrune(t)||n(t,s))return null;if("dynamic"!==t.eventMode&&"dynamic"!==e||(Ji.pauseUpdate=!1),t.interactiveChildren&&t.children){const r=t.children,a=s;for(let s=r.length-1;s>=0;s--){const o=r[s],h=this.hitTestRecursive(o,this._isInteractive(e)?e:o.eventMode,a,i,n);if(h){if(h.length>0&&!h[h.length-1].parent)continue;const e=t.isInteractive();return(h.length>0||e)&&h.push(t),h}}}const r=this._isInteractive(e),a=t.isInteractive();return r&&i(t,s)?a?[t]:[]:null}_isInteractive(t){return"static"===t||"dynamic"===t}_interactivePrune(t){return!(t&&t.visible&&t.renderable&&t.measurable)||("none"===t.eventMode||"passive"===t.eventMode&&!t.interactiveChildren)}hitPruneFn(t,e){if(t.hitArea&&(t.worldTransform.applyInverse(e,rn),!t.hitArea.contains(rn.x,rn.y)))return!0;if(t.effects&&t.effects.length)for(let s=0;s<t.effects.length;s++){const i=t.effects[s];if(i.containsPoint){if(!i.containsPoint(e,this.hitTestFn))return!0}}return!1}hitTestFn(t,e){return!!t.hitArea||!!t?.containsPoint&&(t.worldTransform.applyInverse(e,rn),t.containsPoint(rn))}notifyTarget(t,e){if(!t.currentTarget.isInteractive())return;e??(e=t.type);const s=`on${e}`;t.currentTarget[s]?.(t);const i=t.eventPhase===t.CAPTURING_PHASE||t.eventPhase===t.AT_TARGET?`${e}capture`:e;this._notifyListeners(t,i),t.eventPhase===t.AT_TARGET&&this._notifyListeners(t,e)}mapPointerDown(t){if(!(t instanceof en))return void jt();const e=this.createPointerEvent(t);if(this.dispatchEvent(e,"pointerdown"),"touch"===e.pointerType)this.dispatchEvent(e,"touchstart");else if("mouse"===e.pointerType||"pen"===e.pointerType){const t=2===e.button;this.dispatchEvent(e,t?"rightdown":"mousedown")}this.trackingData(t.pointerId).pressTargetsByButton[t.button]=e.composedPath(),this.freeEvent(e)}mapPointerMove(t){if(!(t instanceof en))return void jt();this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const e=this.createPointerEvent(t);this._isPointerMoveEvent=!1;const s="mouse"===e.pointerType||"pen"===e.pointerType,i=this.trackingData(t.pointerId),n=this.findMountedTarget(i.overTargets);if(i.overTargets?.length>0&&n!==e.target){const i="mousemove"===t.type?"mouseout":"pointerout",r=this.createPointerEvent(t,i,n);if(this.dispatchEvent(r,"pointerout"),s&&this.dispatchEvent(r,"mouseout"),!e.composedPath().includes(n)){const i=this.createPointerEvent(t,"pointerleave",n);for(i.eventPhase=i.AT_TARGET;i.target&&!e.composedPath().includes(i.target);)i.currentTarget=i.target,this.notifyTarget(i),s&&this.notifyTarget(i,"mouseleave"),i.target=i.target.parent;this.freeEvent(i)}this.freeEvent(r)}if(n!==e.target){const i="mousemove"===t.type?"mouseover":"pointerover",r=this.clonePointerEvent(e,i);this.dispatchEvent(r,"pointerover"),s&&this.dispatchEvent(r,"mouseover");let a=n?.parent;for(;a&&a!==this.rootTarget.parent&&a!==e.target;)a=a.parent;if(!a||a===this.rootTarget.parent){const t=this.clonePointerEvent(e,"pointerenter");for(t.eventPhase=t.AT_TARGET;t.target&&t.target!==n&&t.target!==this.rootTarget.parent;)t.currentTarget=t.target,this.notifyTarget(t),s&&this.notifyTarget(t,"mouseenter"),t.target=t.target.parent;this.freeEvent(t)}this.freeEvent(r)}const r=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?r.push("pointermove"):this.dispatchEvent(e,"pointermove"),a&&r.push("globalpointermove"),"touch"===e.pointerType&&(this.moveOnAll?r.splice(1,0,"touchmove"):this.dispatchEvent(e,"touchmove"),a&&r.push("globaltouchmove")),s&&(this.moveOnAll?r.splice(1,0,"mousemove"):this.dispatchEvent(e,"mousemove"),a&&r.push("globalmousemove"),this.cursor=e.target?.cursor),r.length>0&&this.all(e,r),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=e.composedPath(),this.freeEvent(e)}mapPointerOver(t){if(!(t instanceof en))return void jt();const e=this.trackingData(t.pointerId),s=this.createPointerEvent(t),i="mouse"===s.pointerType||"pen"===s.pointerType;this.dispatchEvent(s,"pointerover"),i&&this.dispatchEvent(s,"mouseover"),"mouse"===s.pointerType&&(this.cursor=s.target?.cursor);const n=this.clonePointerEvent(s,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),i&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;e.overTargets=s.composedPath(),this.freeEvent(s),this.freeEvent(n)}mapPointerOut(t){if(!(t instanceof en))return void jt();const e=this.trackingData(t.pointerId);if(e.overTargets){const s="mouse"===t.pointerType||"pen"===t.pointerType,i=this.findMountedTarget(e.overTargets),n=this.createPointerEvent(t,"pointerout",i);this.dispatchEvent(n),s&&this.dispatchEvent(n,"mouseout");const r=this.createPointerEvent(t,"pointerleave",i);for(r.eventPhase=r.AT_TARGET;r.target&&r.target!==this.rootTarget.parent;)r.currentTarget=r.target,this.notifyTarget(r),s&&this.notifyTarget(r,"mouseleave"),r.target=r.target.parent;e.overTargets=null,this.freeEvent(n),this.freeEvent(r)}this.cursor=null}mapPointerUp(t){if(!(t instanceof en))return void jt();const e=performance.now(),s=this.createPointerEvent(t);if(this.dispatchEvent(s,"pointerup"),"touch"===s.pointerType)this.dispatchEvent(s,"touchend");else if("mouse"===s.pointerType||"pen"===s.pointerType){const t=2===s.button;this.dispatchEvent(s,t?"rightup":"mouseup")}const i=this.trackingData(t.pointerId),n=this.findMountedTarget(i.pressTargetsByButton[t.button]);let r=n;if(n&&!s.composedPath().includes(n)){let e=n;for(;e&&!s.composedPath().includes(e);){if(s.currentTarget=e,this.notifyTarget(s,"pointerupoutside"),"touch"===s.pointerType)this.notifyTarget(s,"touchendoutside");else if("mouse"===s.pointerType||"pen"===s.pointerType){const t=2===s.button;this.notifyTarget(s,t?"rightupoutside":"mouseupoutside")}e=e.parent}delete i.pressTargetsByButton[t.button],r=e}if(r){const n=this.clonePointerEvent(s,"click");n.target=r,n.path=null,i.clicksByButton[t.button]||(i.clicksByButton[t.button]={clickCount:0,target:n.target,timeStamp:e});const a=i.clicksByButton[t.button];if(a.target===n.target&&e-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=n.target,a.timeStamp=e,n.detail=a.clickCount,"mouse"===n.pointerType){const t=2===n.button;this.dispatchEvent(n,t?"rightclick":"click")}else"touch"===n.pointerType&&this.dispatchEvent(n,"tap");this.dispatchEvent(n,"pointertap"),this.freeEvent(n)}this.freeEvent(s)}mapPointerUpOutside(t){if(!(t instanceof en))return void jt();const e=this.trackingData(t.pointerId),s=this.findMountedTarget(e.pressTargetsByButton[t.button]),i=this.createPointerEvent(t);if(s){let n=s;for(;n;)i.currentTarget=n,this.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType?this.notifyTarget(i,"touchendoutside"):"mouse"!==i.pointerType&&"pen"!==i.pointerType||this.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),n=n.parent;delete e.pressTargetsByButton[t.button]}this.freeEvent(i)}mapWheel(t){if(!(t instanceof sn))return void jt();const e=this.createWheelEvent(t);this.dispatchEvent(e),this.freeEvent(e)}findMountedTarget(t){if(!t)return null;let e=t[0];for(let s=1;s<t.length&&t[s].parent===e;s++)e=t[s];return e}createPointerEvent(t,e,s){const i=this.allocateEvent(en);return this.copyPointerData(t,i),this.copyMouseData(t,i),this.copyData(t,i),i.nativeEvent=t.nativeEvent,i.originalEvent=t,i.target=s??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],"string"==typeof e&&(i.type=e),i}createWheelEvent(t){const e=this.allocateEvent(sn);return this.copyWheelData(t,e),this.copyMouseData(t,e),this.copyData(t,e),e.nativeEvent=t.nativeEvent,e.originalEvent=t,e.target=this.hitTest(e.global.x,e.global.y),e}clonePointerEvent(t,e){const s=this.allocateEvent(en);return s.nativeEvent=t.nativeEvent,s.originalEvent=t.originalEvent,this.copyPointerData(t,s),this.copyMouseData(t,s),this.copyData(t,s),s.target=t.target,s.path=t.composedPath().slice(),s.type=e??s.type,s}copyWheelData(t,e){e.deltaMode=t.deltaMode,e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ}copyPointerData(t,e){t instanceof en&&e instanceof en&&(e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist)}copyMouseData(t,e){t instanceof tn&&e instanceof tn&&(e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.copyFrom(t.client),e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.copyFrom(t.movement),e.screen.copyFrom(t.screen),e.shiftKey=t.shiftKey,e.global.copyFrom(t.global))}copyData(t,e){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.detail=t.detail,e.view=t.view,e.which=t.which,e.layer.copyFrom(t.layer),e.page.copyFrom(t.page)}trackingData(t){return this.mappingState.trackingData[t]||(this.mappingState.trackingData[t]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[t]}allocateEvent(t){this.eventPool.has(t)||this.eventPool.set(t,[]);const e=this.eventPool.get(t).pop()||new t(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.defaultPrevented=!1,e.path=null,e.target=null,e}freeEvent(t){if(t.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const e=t.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(t)}_notifyListeners(t,e){const s=t.currentTarget._events[e];if(s)if("fn"in s)s.once&&t.currentTarget.removeListener(e,s.fn,void 0,!0),s.fn.call(s.context,t);else for(let i=0,n=s.length;i<n&&!t.propagationImmediatelyStopped;i++)s[i].once&&t.currentTarget.removeListener(e,s[i].fn,void 0,!0),s[i].fn.call(s[i].context,t)}}const on={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},hn=class t{constructor(e){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=e,this.rootBoundary=new an(null),Ji.init(this),this.autoPreventDefault=!0,this._eventsAdded=!1,this._rootPointerEvent=new en(null),this._rootWheelEvent=new sn(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...t.defaultEventFeatures},{set:(t,e,s)=>("globalMove"===e&&(this.rootBoundary.enableGlobalMoveEvents=s),t[e]=s,!0)}),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerOverOut=this._onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(e){const{canvas:s,resolution:i}=this.renderer;this.setTargetElement(s),this.resolution=i,t._defaultEventMode=e.eventMode??"passive",Object.assign(this.features,e.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(t){this.resolution=t}destroy(){Ji.destroy(),this.setTargetElement(null),this.renderer=null,this._currentCursor=null}setCursor(t){t||(t="default");let e=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(e=!1),this._currentCursor===t)return;this._currentCursor=t;const s=this.cursorStyles[t];if(s)switch(typeof s){case"string":e&&(this.domElement.style.cursor=s);break;case"function":s(t);break;case"object":e&&Object.assign(this.domElement.style,s)}else e&&"string"==typeof t&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,t)&&(this.domElement.style.cursor=t)}get pointer(){return this._rootPointerEvent}_onPointerDown(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this._normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized){(t.cancelable||!("cancelable"in t))&&t.preventDefault()}for(let s=0,i=e.length;s<i;s++){const t=e[s],i=this._bootstrapEvent(this._rootPointerEvent,t);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}_onPointerMove(t){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,Ji.pointerMoved();const e=this._normalizeToPointerData(t);for(let s=0,i=e.length;s<i;s++){const t=this._bootstrapEvent(this._rootPointerEvent,e[s]);this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}_onPointerUp(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let e=t.target;t.composedPath&&t.composedPath().length>0&&(e=t.composedPath()[0]);const s=e!==this.domElement?"outside":"",i=this._normalizeToPointerData(t);for(let n=0,r=i.length;n<r;n++){const t=this._bootstrapEvent(this._rootPointerEvent,i[n]);t.type+=s,this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}_onPointerOverOut(t){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const e=this._normalizeToPointerData(t);for(let s=0,i=e.length;s<i;s++){const t=this._bootstrapEvent(this._rootPointerEvent,e[s]);this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}onWheel(t){if(!this.features.wheel)return;const e=this.normalizeWheelEvent(t);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(e)}setTargetElement(t){this._removeEvents(),this.domElement=t,Ji.domElement=t,this._addEvents()}_addEvents(){if(this._eventsAdded||!this.domElement)return;Ji.addTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this._onPointerMove,!0),this.domElement.addEventListener("pointerdown",this._onPointerDown,!0),this.domElement.addEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this._onPointerOverOut,!0),globalThis.addEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this._onPointerMove,!0),this.domElement.addEventListener("mousedown",this._onPointerDown,!0),this.domElement.addEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this._onPointerOverOut,!0),globalThis.addEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this._onPointerDown,!0),this.domElement.addEventListener("touchend",this._onPointerUp,!0),this.domElement.addEventListener("touchmove",this._onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this._eventsAdded=!0}_removeEvents(){if(!this._eventsAdded||!this.domElement)return;Ji.removeTickerListener();const t=this.domElement.style;t&&(globalThis.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction="")),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this._onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this._onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this._onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this._onPointerMove,!0),this.domElement.removeEventListener("mousedown",this._onPointerDown,!0),this.domElement.removeEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this._onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this._onPointerDown,!0),this.domElement.removeEventListener("touchend",this._onPointerUp,!0),this.domElement.removeEventListener("touchmove",this._onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this._eventsAdded=!1}mapPositionToPoint(t,e,s){const i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;t.x=(e-i.left)*(this.domElement.width/i.width)*n,t.y=(s-i.top)*(this.domElement.height/i.height)*n}_normalizeToPointerData(t){const e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(let s=0,i=t.changedTouches.length;s<i;s++){const i=t.changedTouches[s];void 0===i.button&&(i.button=0),void 0===i.buttons&&(i.buttons=1),void 0===i.isPrimary&&(i.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===i.width&&(i.width=i.radiusX||1),void 0===i.height&&(i.height=i.radiusY||1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="touch"),void 0===i.pointerId&&(i.pointerId=i.identifier||0),void 0===i.pressure&&(i.pressure=i.force||.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),void 0===i.layerX&&(i.layerX=i.offsetX=i.clientX),void 0===i.layerY&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=t.type,e.push(i)}else if(globalThis.MouseEvent&&(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof globalThis.PointerEvent))e.push(t);else{const s=t;void 0===s.isPrimary&&(s.isPrimary=!0),void 0===s.width&&(s.width=1),void 0===s.height&&(s.height=1),void 0===s.tiltX&&(s.tiltX=0),void 0===s.tiltY&&(s.tiltY=0),void 0===s.pointerType&&(s.pointerType="mouse"),void 0===s.pointerId&&(s.pointerId=1),void 0===s.pressure&&(s.pressure=.5),void 0===s.twist&&(s.twist=0),void 0===s.tangentialPressure&&(s.tangentialPressure=0),s.isNormalized=!0,e.push(s)}return e}normalizeWheelEvent(t){const e=this._rootWheelEvent;return this._transferMouseData(e,t),e.deltaX=t.deltaX,e.deltaY=t.deltaY,e.deltaZ=t.deltaZ,e.deltaMode=t.deltaMode,this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.nativeEvent=t,e.type=t.type,e}_bootstrapEvent(t,e){return t.originalEvent=null,t.nativeEvent=e,t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist,this._transferMouseData(t,e),this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.isTrusted=e.isTrusted,"pointerleave"===t.type&&(t.type="pointerout"),t.type.startsWith("mouse")&&(t.type=t.type.replace("mouse","pointer")),t.type.startsWith("touch")&&(t.type=on[t.type]||t.type),t}_transferMouseData(t,e){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.x=e.clientX,t.client.y=e.clientY,t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.x=e.movementX,t.movement.y=e.movementY,t.page.x=e.pageX,t.page.y=e.pageY,t.relatedTarget=null,t.shiftKey=e.shiftKey}};hn.extension={name:"events",type:[it.WebGLSystem,it.CanvasSystem,it.WebGPUSystem],priority:-1},hn.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let ln=hn;const cn={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return"dynamic"===this.eventMode||"static"===this.eventMode},set interactive(t){this.eventMode=t?"static":"passive"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??ln.defaultEventMode},set eventMode(t){this._internalEventMode=t},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(t,e,s){const i="boolean"==typeof s&&s||"object"==typeof s&&s.capture,n="object"==typeof s?s.signal:void 0,r="object"==typeof s&&!0===s.once,a="function"==typeof e?void 0:e;t=i?`${t}capture`:t;const o="function"==typeof e?e:e.handleEvent,h=this;n&&n.addEventListener("abort",()=>{h.off(t,o,a)}),r?h.once(t,o,a):h.on(t,o,a)},removeEventListener(t,e,s){const i="function"==typeof e?void 0:e;t="boolean"==typeof s&&s||"object"==typeof s&&s.capture?`${t}capture`:t,e="function"==typeof e?e:e.handleEvent,this.off(t,e,i)},dispatchEvent(t){if(!(t instanceof we))throw new Error("Container cannot propagate events outside of the Federated Events API");return t.defaultPrevented=!1,t.path=null,t.target=this,t.manager.dispatchEvent(t),!t.defaultPrevented}},dn=class t extends T{constructor(...e){let s=e[0]??{};s instanceof Float32Array&&(Ft(0,"use new MeshGeometry({ positions, uvs, indices }) instead"),s={positions:s,uvs:e[1],indices:e[2]}),s={...t.defaultOptions,...s};const i=s.positions||new Float32Array([0,0,1,0,1,1,0,1]);let n=s.uvs;n||(n=s.positions?new Float32Array(i.length):new Float32Array([0,0,1,0,1,1,0,1]));const r=s.indices||new Uint32Array([0,1,2,0,2,3]),a=s.shrinkBuffersToFit;super({attributes:{aPosition:{buffer:new E({data:i,label:"attribute-mesh-positions",shrinkToFit:a,usage:P.VERTEX|P.COPY_DST}),format:"float32x2",stride:8,offset:0},aUV:{buffer:new E({data:n,label:"attribute-mesh-uvs",shrinkToFit:a,usage:P.VERTEX|P.COPY_DST}),format:"float32x2",stride:8,offset:0}},indexBuffer:new E({data:r,label:"index-mesh-buffer",shrinkToFit:a,usage:P.INDEX|P.COPY_DST}),topology:s.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};dn.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let un=dn;class pn{constructor({matrix:t,observer:e}={}){this.dirty=!0,this._matrix=t??new mt,this.observer=e,this.position=new lt(this,0,0),this.scale=new lt(this,1,1),this.pivot=new lt(this,0,0),this.skew=new lt(this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1}get matrix(){const t=this._matrix;return this.dirty?(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this.dirty=!1,t):t}_onUpdate(t){this.dirty=!0,t===this.skew&&this.updateSkew(),this.observer?._onUpdate(this)}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this.dirty=!0}toString(){return`[pixi.js/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`}setFromMatrix(t){t.decompose(this),this.dirty=!0}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this.skew))}}let fn=null,mn=null;function gn(t,e,s){for(let i=0,n=4*s*e;i<e;++i,n+=4)if(0!==t[n+3])return!1;return!0}function _n(t,e,s,i,n){const r=4*e;for(let a=i,o=i*r+4*s;a<=n;++a,o+=r)if(0!==t[o+3])return!1;return!0}function yn(...t){let e=t[0];e.canvas||(e={canvas:t[0],resolution:t[1]});const{canvas:s}=e,i=Math.min(e.resolution??1,1),n=e.width??s.width,r=e.height??s.height;let a=e.output;if(function(t,e){fn||(fn=ne.get().createCanvas(256,128),mn=fn.getContext("2d",{willReadFrequently:!0}),mn.globalCompositeOperation="copy",mn.globalAlpha=1),(fn.width<t||fn.height<e)&&(fn.width=Lt(t),fn.height=Lt(e))}(n,r),!mn)throw new TypeError("Failed to get canvas 2D context");mn.drawImage(s,0,0,n,r,0,0,n*i,r*i);const o=mn.getImageData(0,0,n,r).data;let h=0,l=0,c=n-1,d=r-1;for(;l<r&&gn(o,n,l);)++l;if(l===r)return St.EMPTY;for(;gn(o,n,d);)--d;for(;_n(o,n,h,l,d);)++h;for(;_n(o,n,c,l,d);)--c;return++c,++d,mn.globalCompositeOperation="source-over",mn.strokeRect(h,l,c-h,d-l),mn.globalCompositeOperation="copy",a??(a=new St),a.set(h/i,l/i,(c-h)/i,(d-l)/i),a}const vn=new St;const xn=new class{getCanvasAndContext(t){const{text:e,style:s,resolution:i=1}=t,n=s._getFinalPadding(),r=Ye.measureText(e||" ",s),a=Math.ceil(Math.ceil(Math.max(1,r.width)+2*n)*i),o=Math.ceil(Math.ceil(Math.max(1,r.height)+2*n)*i),h=I.getOptimalCanvasAndContext(a,o);this._renderTextToCanvas(e,s,n,i,h);return{canvasAndContext:h,frame:s.trim?yn({canvas:h.canvas,width:a,height:o,resolution:1,output:vn}):vn.set(0,0,a,o)}}returnCanvasAndContext(t){I.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,s,i,n){const{canvas:r,context:a}=n,o=He(e),h=Ye.measureText(t||" ",e),l=h.lines,c=h.lineHeight,d=h.lineWidths,u=h.maxLineWidth,p=h.fontProperties,f=r.height;if(a.resetTransform(),a.scale(i,i),a.textBaseline=e.textBaseline,e._stroke?.width){const t=e._stroke;a.lineWidth=t.width,a.miterLimit=t.miterLimit,a.lineJoin=t.join,a.lineCap=t.cap}let m,g;a.font=o;const _=e.dropShadow?2:1;for(let y=0;y<_;++y){const t=e.dropShadow&&0===y,r=t?Math.ceil(Math.max(1,f)+2*s):0,o=r*i;if(t){a.fillStyle="black",a.strokeStyle="black";const t=e.dropShadow,s=t.color,n=t.alpha;a.shadowColor=Wt.shared.setValue(s).setAlpha(n).toRgbaString();const r=t.blur*i,h=t.distance*i;a.shadowBlur=r,a.shadowOffsetX=Math.cos(t.angle)*h,a.shadowOffsetY=Math.sin(t.angle)*h+o}else{if(a.fillStyle=e._fill?si(e._fill,a,h,2*s):null,e._stroke?.width){const t=.5*e._stroke.width+2*s;a.strokeStyle=si(e._stroke,a,h,t)}a.shadowColor="black"}let _=(c-p.fontSize)/2;c-p.fontSize<0&&(_=0);const v=e._stroke?.width??0;for(let i=0;i<l.length;i++)m=v/2,g=v/2+i*c+p.ascent+_,"right"===e.align?m+=u-d[i]:"center"===e.align&&(m+=(u-d[i])/2),e._stroke?.width&&this._drawLetterSpacing(l[i],e,n,m+s,g+s-r,!0),void 0!==e._fill&&this._drawLetterSpacing(l[i],e,n,m+s,g+s-r)}}_drawLetterSpacing(t,e,s,i,n,r=!1){const{context:a}=s,o=e.letterSpacing;let h=!1;if(Ye.experimentalLetterSpacingSupported&&(Ye.experimentalLetterSpacing?(a.letterSpacing=`${o}px`,a.textLetterSpacing=`${o}px`,h=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),0===o||h)return void(r?a.strokeText(t,i,n):a.fillText(t,i,n));let l=i;const c=Ye.graphemeSegmenter(t);let d=a.measureText(t).width,u=0;for(let p=0;p<c.length;++p){const t=c[p];r?a.strokeText(t,l,n):a.fillText(t,l,n);let e="";for(let s=p+1;s<c.length;++s)e+=c[s];u=a.measureText(e).width,l+=d-u+o,d=u}}},bn="http://www.w3.org/2000/svg",An="http://www.w3.org/1999/xhtml";class wn{constructor(){this.svgRoot=document.createElementNS(bn,"svg"),this.foreignObject=document.createElementNS(bn,"foreignObject"),this.domElement=document.createElementNS(An,"div"),this.styleElement=document.createElementNS(An,"style");const{foreignObject:t,svgRoot:e,styleElement:s,domElement:i}=this;t.setAttribute("width","10000"),t.setAttribute("height","10000"),t.style.overflow="hidden",e.appendChild(t),t.appendChild(s),t.appendChild(i),this.image=ne.get().createImage()}destroy(){this.svgRoot.remove(),this.foreignObject.remove(),this.styleElement.remove(),this.domElement.remove(),this.image.src="",this.image.remove(),this.svgRoot=null,this.foreignObject=null,this.styleElement=null,this.domElement=null,this.image=null,this.canvasAndContext=null}}let Tn;class En{constructor(){this._tempState=O.for2d(),this._didUploadHash={}}init(t){t.renderer.runners.contextChange.add(this)}contextChange(){this._didUploadHash={}}start(t,e,s){const i=t.renderer,n=this._didUploadHash[s.uid];i.shader.bind(s,n),n||(this._didUploadHash[s.uid]=!0),i.shader.updateUniformGroup(i.globalUniforms.uniformGroup),i.geometry.bind(e,s.glProgram)}execute(t,e){const s=t.renderer;this._tempState.blendMode=e.blendMode,s.state.set(this._tempState);const i=e.textures.textures;for(let n=0;n<e.textures.count;n++)s.texture.bind(i[n],n);s.geometry.draw(e.topology,e.size,e.start)}}En.extension={type:[it.WebGLPipesAdaptor],name:"batch"};const Pn=O.for2d();class Sn{start(t,e,s){const i=t.renderer,n=i.encoder,r=s.gpuProgram;this._shader=s,this._geometry=e,n.setGeometry(e,r),Pn.blendMode="normal",i.pipeline.getPipeline(e,r,Pn);const a=i.globalUniforms.bindGroup;n.resetBindGroup(1),n.setBindGroup(0,a,r)}execute(t,e){const s=this._shader.gpuProgram,i=t.renderer,n=i.encoder;if(!e.bindGroup){const t=e.textures;e.bindGroup=ss(t.textures,t.count,i.limits.maxBatchableTextures)}Pn.blendMode=e.blendMode;const r=i.bindGroup.getBindGroup(e.bindGroup,s,1),a=i.pipeline.getPipeline(this._geometry,s,Pn,e.topology);e.bindGroup._touch(i.textureGC.count),n.setPipeline(a),n.renderPassEncoder.setBindGroup(1,r),n.renderPassEncoder.drawIndexed(e.size,1,e.start)}}Sn.extension={type:[it.WebGPUPipesAdaptor],name:"batch"};const Mn=class t{constructor(t,e){this.state=O.for2d(),this._batchersByInstructionSet=Object.create(null),this._activeBatches=Object.create(null),this.renderer=t,this._adaptor=e,this._adaptor.init?.(this)}static getBatcher(t){return new this._availableBatchers[t]}buildStart(t){let e=this._batchersByInstructionSet[t.uid];e||(e=this._batchersByInstructionSet[t.uid]=Object.create(null),e.default||(e.default=new Zs({maxTextures:this.renderer.limits.maxBatchableTextures}))),this._activeBatches=e,this._activeBatch=this._activeBatches.default;for(const s in this._activeBatches)this._activeBatches[s].begin()}addToBatch(e,s){if(this._activeBatch.name!==e.batcherName){this._activeBatch.break(s);let i=this._activeBatches[e.batcherName];i||(i=this._activeBatches[e.batcherName]=t.getBatcher(e.batcherName),i.begin()),this._activeBatch=i}this._activeBatch.add(e)}break(t){this._activeBatch.break(t)}buildEnd(t){this._activeBatch.break(t);const e=this._activeBatches;for(const s in e){const t=e[s],i=t.geometry;i.indexBuffer.setDataWithSize(t.indexBuffer,t.indexSize,!0),i.buffers[0].setDataWithSize(t.attributeBuffer.float32View,t.attributeSize,!1)}}upload(t){const e=this._batchersByInstructionSet[t.uid];for(const s in e){const t=e[s],i=t.geometry;t.dirty&&(t.dirty=!1,i.buffers[0].update(4*t.attributeSize))}}execute(t){if("startBatch"===t.action){const e=t.batcher,s=e.geometry,i=e.shader;this._adaptor.start(this,s,i)}this._adaptor.execute(this,t)}destroy(){this.state=null,this.renderer=null,this._adaptor=null;for(const t in this._activeBatches)this._activeBatches[t].destroy();this._activeBatches=null}};Mn.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"batch"},Mn._availableBatchers=Object.create(null);let kn=Mn;at.handleByMap(it.Batcher,kn._availableBatchers),at.add(Zs);const Cn={name:"local-uniform-bit",vertex:{header:"\n\n            struct LocalUniforms {\n                uTransformMatrix:mat3x3<f32>,\n                uColor:vec4<f32>,\n                uRound:f32,\n            }\n\n            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        ",main:"\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        ",end:"\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        "}},Bn={...Cn,vertex:{...Cn.vertex,header:Cn.vertex.header.replace("group(1)","group(2)")}},In={name:"local-uniform-bit",vertex:{header:"\n\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        ",main:"\n            vColor *= uColor;\n            modelMatrix = uTransformMatrix;\n        ",end:"\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        "}},On=new e;class Fn extends N{constructor(){super(),this.filters=[new H({sprite:new V(v.EMPTY),inverse:!1,resolution:"inherit",antialias:"inherit"})]}get sprite(){return this.filters[0].sprite}set sprite(t){this.filters[0].sprite=t}get inverse(){return this.filters[0].inverse}set inverse(t){this.filters[0].inverse=t}}class Rn{constructor(t){this._activeMaskStage=[],this._renderer=t}push(t,e,s){const i=this._renderer;if(i.renderPipes.batch.break(s),s.add({renderPipeId:"alphaMask",action:"pushMaskBegin",mask:t,inverse:e._maskOptions.inverse,canBundle:!1,maskedContainer:e}),t.inverse=e._maskOptions.inverse,t.renderMaskToTexture){const e=t.mask;e.includeInBuild=!0,e.collectRenderables(s,i,null),e.includeInBuild=!1}i.renderPipes.batch.break(s),s.add({renderPipeId:"alphaMask",action:"pushMaskEnd",mask:t,maskedContainer:e,inverse:e._maskOptions.inverse,canBundle:!1})}pop(t,e,s){this._renderer.renderPipes.batch.break(s),s.add({renderPipeId:"alphaMask",action:"popMaskEnd",mask:t,inverse:e._maskOptions.inverse,canBundle:!1})}execute(t){const e=this._renderer,i=t.mask.renderMaskToTexture;if("pushMaskBegin"===t.action){const n=Vt.get(Fn);if(n.inverse=t.inverse,i){t.mask.mask.measurable=!0;const i=s(t.mask.mask,!0,On);t.mask.mask.measurable=!1,i.ceil();const r=e.renderTarget.renderTarget.colorTexture.source,a=F.getOptimalTexture(i.width,i.height,r._resolution,r.antialias);e.renderTarget.push(a,!0),e.globalUniforms.push({offset:i,worldColor:4294967295});const o=n.sprite;o.texture=a,o.worldTransform.tx=i.minX,o.worldTransform.ty=i.minY,this._activeMaskStage.push({filterEffect:n,maskedContainer:t.maskedContainer,filterTexture:a})}else n.sprite=t.mask.mask,this._activeMaskStage.push({filterEffect:n,maskedContainer:t.maskedContainer})}else if("pushMaskEnd"===t.action){const t=this._activeMaskStage[this._activeMaskStage.length-1];i&&(e.type===R.WEBGL&&e.renderTarget.finishRenderPass(),e.renderTarget.pop(),e.globalUniforms.pop()),e.filter.push({renderPipeId:"filter",action:"pushFilter",container:t.maskedContainer,filterEffect:t.filterEffect,canBundle:!1})}else if("popMaskEnd"===t.action){e.filter.pop();const t=this._activeMaskStage.pop();i&&F.returnTexture(t.filterTexture),Vt.return(t.filterEffect)}}destroy(){this._renderer=null,this._activeMaskStage=null}}Rn.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"alphaMask"};class Ln{constructor(t){this._colorStack=[],this._colorStackIndex=0,this._currentColor=0,this._renderer=t}buildStart(){this._colorStack[0]=15,this._colorStackIndex=1,this._currentColor=15}push(t,e,s){this._renderer.renderPipes.batch.break(s);const i=this._colorStack;i[this._colorStackIndex]=i[this._colorStackIndex-1]&t.mask;const n=this._colorStack[this._colorStackIndex];n!==this._currentColor&&(this._currentColor=n,s.add({renderPipeId:"colorMask",colorMask:n,canBundle:!1})),this._colorStackIndex++}pop(t,e,s){this._renderer.renderPipes.batch.break(s);const i=this._colorStack;this._colorStackIndex--;const n=i[this._colorStackIndex-1];n!==this._currentColor&&(this._currentColor=n,s.add({renderPipeId:"colorMask",colorMask:n,canBundle:!1}))}execute(t){this._renderer.colorMask.setMask(t.colorMask)}destroy(){this._renderer=null,this._colorStack=null}}Ln.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"colorMask"};class Dn{constructor(t){this._maskStackHash={},this._maskHash=new WeakMap,this._renderer=t}push(t,e,s){var i;const n=t,r=this._renderer;r.renderPipes.batch.break(s),r.renderPipes.blendMode.setBlendMode(n.mask,"none",s),s.add({renderPipeId:"stencilMask",action:"pushMaskBegin",mask:t,inverse:e._maskOptions.inverse,canBundle:!1});const a=n.mask;a.includeInBuild=!0,this._maskHash.has(n)||this._maskHash.set(n,{instructionsStart:0,instructionsLength:0});const o=this._maskHash.get(n);o.instructionsStart=s.instructionSize,a.collectRenderables(s,r,null),a.includeInBuild=!1,r.renderPipes.batch.break(s),s.add({renderPipeId:"stencilMask",action:"pushMaskEnd",mask:t,inverse:e._maskOptions.inverse,canBundle:!1});const h=s.instructionSize-o.instructionsStart-1;o.instructionsLength=h;const l=r.renderTarget.renderTarget.uid;(i=this._maskStackHash)[l]??(i[l]=0)}pop(t,e,s){const i=t,n=this._renderer;n.renderPipes.batch.break(s),n.renderPipes.blendMode.setBlendMode(i.mask,"none",s),s.add({renderPipeId:"stencilMask",action:"popMaskBegin",inverse:e._maskOptions.inverse,canBundle:!1});const r=this._maskHash.get(t);for(let a=0;a<r.instructionsLength;a++)s.instructions[s.instructionSize++]=s.instructions[r.instructionsStart++];s.add({renderPipeId:"stencilMask",action:"popMaskEnd",canBundle:!1})}execute(t){var e;const s=this._renderer,i=s.renderTarget.renderTarget.uid;let n=(e=this._maskStackHash)[i]??(e[i]=0);"pushMaskBegin"===t.action?(s.renderTarget.ensureDepthStencil(),s.stencil.setStencilMode(L.RENDERING_MASK_ADD,n),n++,s.colorMask.setMask(0)):"pushMaskEnd"===t.action?(t.inverse?s.stencil.setStencilMode(L.INVERSE_MASK_ACTIVE,n):s.stencil.setStencilMode(L.MASK_ACTIVE,n),s.colorMask.setMask(15)):"popMaskBegin"===t.action?(s.colorMask.setMask(0),0!==n?s.stencil.setStencilMode(L.RENDERING_MASK_REMOVE,n):(s.renderTarget.clear(null,D.STENCIL),s.stencil.setStencilMode(L.DISABLED,n)),n--):"popMaskEnd"===t.action&&(t.inverse?s.stencil.setStencilMode(L.INVERSE_MASK_ACTIVE,n):s.stencil.setStencilMode(L.MASK_ACTIVE,n),s.colorMask.setMask(15)),this._maskStackHash[i]=n}destroy(){this._renderer=null,this._maskStackHash=null,this._maskHash=null}}Dn.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"stencilMask"};class Un{init(){const t=Ds({name:"mesh",bits:[In,G,Ys]});this._shader=new k({glProgram:t,resources:{uTexture:v.EMPTY.source,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new mt}}}})}execute(t,e){const s=t.renderer;let i=e._shader;if(i){if(!i.glProgram)return void jt(e.shader)}else{i=this._shader;const t=e.texture,s=t.source;i.resources.uTexture=s,i.resources.uSampler=s.style,i.resources.textureUniforms.uniforms.uTextureMatrix=t.textureMatrix.mapCoord}i.groups[100]=s.globalUniforms.bindGroup,i.groups[101]=t.localUniformsBindGroup,s.encoder.draw({geometry:e._geometry,shader:i,state:e.state})}destroy(){this._shader.destroy(!0),this._shader=null}}Un.extension={type:[it.WebGLPipesAdaptor],name:"mesh"};let zn=!1;function Wn(t){if(!zn){if(ne.get().getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){const e=[`%c  %c  %c  %c  %c PixiJS %c v${Le} (${t}) http://www.pixijs.com/\n\n`,"background: #E72264; padding:5px 0;","background: #6CA2EA; padding:5px 0;","background: #B5D33D; padding:5px 0;","background: #FED23F; padding:5px 0;","color: #FFFFFF; background: #E72264; padding:5px 0;","color: #E72264; background: #FFFFFF; padding:5px 0;"];globalThis.console.log(...e)}else globalThis.console&&globalThis.console.log(`PixiJS ${Le} - ${t} - http://www.pixijs.com/`);zn=!0}}function $n(t){let e=!1;for(const i in t)if(null==t[i]){e=!0;break}if(!e)return t;const s=Object.create(null);for(const i in t){const e=t[i];e&&(s[i]=e)}return s}function Gn(t){let e=0;for(let s=0;s<t.length;s++)null==t[s]?e++:t[s-e]=t[s];return t.length-=e,t}class jn{init(){const t=Ls({name:"mesh",bits:[Cn,j,Xs]});this._shader=new k({gpuProgram:t,resources:{uTexture:v.EMPTY._source,uSampler:v.EMPTY._source.style,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new mt}}}})}execute(t,e){const s=t.renderer;let i=e._shader;if(i){if(!i.gpuProgram)return void jt(e.shader)}else i=this._shader,i.groups[2]=s.texture.getTextureBindGroup(e.texture);const n=i.gpuProgram;if(n.autoAssignGlobalUniforms&&(i.groups[0]=s.globalUniforms.bindGroup),n.autoAssignLocalUniforms){const e=t.localUniforms;i.groups[1]=s.renderPipes.uniformBatch.getUniformBindGroup(e,!0)}s.encoder.draw({geometry:e._geometry,shader:i,state:e.state})}destroy(){this._shader.destroy(!0),this._shader=null}}jn.extension={type:[it.WebGPUPipesAdaptor],name:"mesh"};const Nn=class t extends un{constructor(...t){super({});let e=t[0]??{};"number"==typeof e&&(Ft(0,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),e={width:e,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(e)}build(e){e={...t.defaultOptions,...e},this.verticesX=this.verticesX??e.verticesX,this.verticesY=this.verticesY??e.verticesY,this.width=this.width??e.width,this.height=this.height??e.height;const s=this.verticesX*this.verticesY,i=[],n=[],r=[],a=this.verticesX-1,o=this.verticesY-1,h=this.width/a,l=this.height/o;for(let t=0;t<s;t++){const e=t%this.verticesX,s=t/this.verticesX|0;i.push(e*h,s*l),n.push(e/a,s/o)}const c=a*o;for(let t=0;t<c;t++){const e=t%a,s=t/a|0,i=s*this.verticesX+e,n=s*this.verticesX+e+1,o=(s+1)*this.verticesX+e,h=(s+1)*this.verticesX+e+1;r.push(i,n,o,n,h,o)}this.buffers[0].data=new Float32Array(i),this.buffers[1].data=new Float32Array(n),this.indexBuffer.data=new Uint32Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};Nn.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let Hn=Nn;class Vn{constructor(){this.batcherName="default",this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._textureMatrixUpdateId=-1,this._uvUpdateId=-1}get blendMode(){return this.renderable.groupBlendMode}get topology(){return this._topology||this.geometry.topology}set topology(t){this._topology=t}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}setTexture(t){this.texture!==t&&(this.texture=t,this._textureMatrixUpdateId=-1)}get uvs(){const t=this.geometry.getBuffer("aUV"),e=t.data;let s=e;const i=this.texture.textureMatrix;return i.isSimple||(s=this._transformedUvs,this._textureMatrixUpdateId===i._updateID&&this._uvUpdateId===t._updateID||((!s||s.length<e.length)&&(s=this._transformedUvs=new Float32Array(e.length)),this._textureMatrixUpdateId=i._updateID,this._uvUpdateId=t._updateID,i.multiplyUvs(e,s))),s}get positions(){return this.geometry.positions}get indices(){return this.geometry.indices}get color(){return this.renderable.groupColorAlpha}get groupTransform(){return this.renderable.groupTransform}get attributeSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}class Xn{destroy(){}}class Yn{constructor(t,e){this.localUniforms=new U({uTransformMatrix:{value:new mt,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new x({0:this.localUniforms}),this.renderer=t,this._adaptor=e,this._adaptor.init()}validateRenderable(t){const e=this._getMeshData(t),s=e.batched,i=t.batched;if(e.batched=i,s!==i)return!0;if(i){const s=t._geometry;if(s.indices.length!==e.indexSize||s.positions.length!==e.vertexSize)return e.indexSize=s.indices.length,e.vertexSize=s.positions.length,!0;const i=this._getBatchableMesh(t);return i.texture.uid!==t._texture.uid&&(i._textureMatrixUpdateId=-1),!i._batcher.checkAndUpdateTexture(i,t._texture)}return!1}addRenderable(t,e){const s=this.renderer.renderPipes.batch,i=this._getMeshData(t);if(t.didViewUpdate&&(i.indexSize=t._geometry.indices?.length,i.vertexSize=t._geometry.positions?.length),i.batched){const i=this._getBatchableMesh(t);i.setTexture(t._texture),i.geometry=t._geometry,s.addToBatch(i,e)}else s.break(e),e.add(t)}updateRenderable(t){if(t.batched){const e=this._getBatchableMesh(t);e.setTexture(t._texture),e.geometry=t._geometry,e._batcher.updateElement(e)}}execute(t){if(!t.isRenderable)return;t.state.blendMode=A(t.groupBlendMode,t.texture._source);const e=this.localUniforms;e.uniforms.uTransformMatrix=t.groupTransform,e.uniforms.uRound=this.renderer._roundPixels|t._roundPixels,e.update(),J(t.groupColorAlpha,e.uniforms.uColor,0),this._adaptor.execute(this,t)}_getMeshData(t){var e,s;return(e=t._gpuData)[s=this.renderer.uid]||(e[s]=new Xn),t._gpuData[this.renderer.uid].meshData||this._initMeshData(t)}_initMeshData(t){return t._gpuData[this.renderer.uid].meshData={batched:t.batched,indexSize:0,vertexSize:0},t._gpuData[this.renderer.uid].meshData}_getBatchableMesh(t){var e,s;return(e=t._gpuData)[s=this.renderer.uid]||(e[s]=new Xn),t._gpuData[this.renderer.uid].batchableMesh||this._initBatchableMesh(t)}_initBatchableMesh(t){const e=new Vn;return e.renderable=t,e.setTexture(t._texture),e.transform=t.groupTransform,e.roundPixels=this.renderer._roundPixels|t._roundPixels,t._gpuData[this.renderer.uid].batchableMesh=e,e}destroy(){this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}Yn.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"mesh"};const Kn={name:"local-uniform-msdf-bit",vertex:{header:"\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32,\n                uRound:f32,\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        ",main:"\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        ",end:"\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        "},fragment:{header:"\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n         ",main:"\n            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));\n        "}},qn={name:"local-uniform-msdf-bit",vertex:{header:"\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        ",main:"\n            vColor *= uColor;\n            modelMatrix *= uTransformMatrix;\n        ",end:"\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        "},fragment:{header:"\n            uniform float uDistance;\n         ",main:"\n            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));\n        "}},Qn={name:"msdf-bit",fragment:{header:"\n            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {\n\n                // MSDF\n                var median = msdfColor.r + msdfColor.g + msdfColor.b -\n                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n\n                // SDF\n                median = min(median, msdfColor.a);\n\n                var screenPxDistance = distance * (median - 0.5);\n                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));\n                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);\n                var coverage: f32 = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n\n            }\n        "}},Zn={name:"msdf-bit",fragment:{header:"\n            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {\n\n                // MSDF\n                float median = msdfColor.r + msdfColor.g + msdfColor.b -\n                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n\n                // SDF\n                median = min(median, msdfColor.a);\n\n                float screenPxDistance = distance * (median - 0.5);\n                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));\n                float gamma = mix(1.0, 1.0 / 2.2, luma);\n                float coverage = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n            }\n        "}};let Jn,tr;class er extends k{constructor(t){const e=new U({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new mt,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}});Jn??(Jn=Ls({name:"sdf-shader",bits:[Us,js(t),Kn,Qn,Xs]})),tr??(tr=Ds({name:"sdf-shader",bits:[zs,Vs(t),qn,Zn,Ys]})),super({glProgram:tr,gpuProgram:Jn,resources:{localUniforms:e,batchSamplers:C(t)}})}}class sr extends tt{destroy(){this.context.customShader&&this.context.customShader.destroy(),super.destroy()}}class ir{constructor(t){this._renderer=t}validateRenderable(t){const e=this._getGpuBitmapText(t);return this._renderer.renderPipes.graphics.validateRenderable(e)}addRenderable(t,e){const s=this._getGpuBitmapText(t);nr(t,s),t._didTextUpdate&&(t._didTextUpdate=!1,this._updateContext(t,s)),this._renderer.renderPipes.graphics.addRenderable(s,e),s.context.customShader&&this._updateDistanceField(t)}updateRenderable(t){const e=this._getGpuBitmapText(t);nr(t,e),this._renderer.renderPipes.graphics.updateRenderable(e),e.context.customShader&&this._updateDistanceField(t)}_updateContext(t,e){const{context:s}=e,i=oi.getFont(t.text,t._style);s.clear(),"none"!==i.distanceField.type&&(s.customShader||(s.customShader=new er(this._renderer.limits.maxBatchableTextures)));const n=Ye.graphemeSegmenter(t.text),r=t._style;let a=i.baseLineOffset;const o=ri(n,r,i,!0),h=r.padding,l=o.scale;let c=o.width,d=o.height+o.offsetY;r._stroke&&(c+=r._stroke.width/l,d+=r._stroke.width/l),s.translate(-t._anchor._x*c-h,-t._anchor._y*d-h).scale(l,l);const u=i.applyFillAsTint?r._fill.color:16777215;let p=i.fontMetrics.fontSize,f=i.lineHeight;r.lineHeight&&(p=r.fontSize/l,f=r.lineHeight/l);let m=(f-p)/2;m-i.baseLineOffset<0&&(m=0);for(let g=0;g<o.lines.length;g++){const t=o.lines[g];for(let e=0;e<t.charPositions.length;e++){const n=t.chars[e],r=i.chars[n];if(r?.texture){const i=r.texture;s.texture(i,u||"black",Math.round(t.charPositions[e]+r.xOffset),Math.round(a+r.yOffset+m),i.orig.width,i.orig.height)}}a+=f}}_getGpuBitmapText(t){return t._gpuData[this._renderer.uid]||this.initGpuText(t)}initGpuText(t){const e=new sr;return t._gpuData[this._renderer.uid]=e,this._updateContext(t,e),e}_updateDistanceField(t){const e=this._getGpuBitmapText(t).context,s=t._style.fontFamily,i=ue.get(`${s}-bitmap`),{a:n,b:r,c:a,d:o}=t.groupTransform,h=Math.sqrt(n*n+r*r),l=Math.sqrt(a*a+o*o),c=(Math.abs(h)+Math.abs(l))/2,d=i.baseRenderedFontSize/t._style.fontSize,u=c*i.distanceField.range*(1/d);e.customShader.resources.localUniforms.uniforms.uDistance=u}destroy(){this._renderer=null}}function nr(t,e){e.groupTransform=t.groupTransform,e.groupColorAlpha=t.groupColorAlpha,e.groupColor=t.groupColor,e.groupBlendMode=t.groupBlendMode,e.globalDisplayStatus=t.globalDisplayStatus,e.groupTransform=t.groupTransform,e.localDisplayStatus=t.localDisplayStatus,e.groupAlpha=t.groupAlpha,e._roundPixels=t._roundPixels}ir.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"bitmapText"};class rr extends X{constructor(t){super(),this.generatingTexture=!1,this.currentKey="--",this._renderer=t,t.runners.resolutionChange.add(this)}resolutionChange(){const t=this.renderable;t._autoResolution&&t.onViewUpdate()}destroy(){const{htmlText:t}=this._renderer;null===t.getReferenceCount(this.currentKey)?t.returnTexturePromise(this.texturePromise):t.decreaseReferenceCount(this.currentKey),this._renderer.runners.resolutionChange.remove(this),this.texturePromise=null,this._renderer=null}}function ar(t,e){const{texture:s,bounds:i}=t,n=e._style._getFinalPadding();Ut(i,e._anchor,s);const r=e._anchor._x*n*2,a=e._anchor._y*n*2;i.minX-=n-r,i.minY-=n-a,i.maxX-=n-r,i.maxY-=n-a}class or{constructor(t){this._renderer=t}validateRenderable(t){const e=this._getGpuText(t),s=t.styleKey;return e.currentKey!==s}addRenderable(t,e){const s=this._getGpuText(t);if(t._didTextUpdate){const e=t._autoResolution?this._renderer.resolution:t.resolution;s.currentKey===t.styleKey&&t.resolution===e||this._updateGpuText(t).catch(t=>{}),t._didTextUpdate=!1,ar(s,t)}this._renderer.renderPipes.batch.addToBatch(s,e)}updateRenderable(t){const e=this._getGpuText(t);e._batcher.updateElement(e)}async _updateGpuText(t){t._didTextUpdate=!1;const e=this._getGpuText(t);if(e.generatingTexture)return;const s=e.texturePromise;e.texturePromise=null,e.generatingTexture=!0,t._resolution=t._autoResolution?this._renderer.resolution:t.resolution;let i=this._renderer.htmlText.getTexturePromise(t);s&&(i=i.finally(()=>{this._renderer.htmlText.decreaseReferenceCount(e.currentKey),this._renderer.htmlText.returnTexturePromise(s)})),e.texturePromise=i,e.currentKey=t.styleKey,e.texture=await i;const n=t.renderGroup||t.parentRenderGroup;n&&(n.structureDidChange=!0),e.generatingTexture=!1,ar(e,t)}_getGpuText(t){return t._gpuData[this._renderer.uid]||this.initGpuText(t)}initGpuText(t){const e=new rr(this._renderer);return e.renderable=t,e.transform=t.groupTransform,e.texture=v.EMPTY,e.bounds={minX:0,maxX:1,minY:0,maxY:0},e.roundPixels=this._renderer._roundPixels|t._roundPixels,t._resolution=t._autoResolution?this._renderer.resolution:t.resolution,t._gpuData[this._renderer.uid]=e,e}destroy(){this._renderer=null}}or.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"htmlText"};const hr=new e;function lr(t,e,s,i){const n=hr;n.minX=0,n.minY=0,n.maxX=t.width/i|0,n.maxY=t.height/i|0;const r=F.getOptimalTexture(n.width,n.height,i,!1);return r.source.uploadMethodId="image",r.source.resource=t,r.source.alphaMode="premultiply-alpha-on-upload",r.frame.width=e/i,r.frame.height=s/i,r.source.emit("update",r.source),r.updateUvs(),r}async function cr(t,e){const s=await async function(t){const e=await ne.get().fetch(t),s=await e.blob(),i=new FileReader;return await new Promise((t,e)=>{i.onloadend=()=>t(i.result),i.onerror=e,i.readAsDataURL(s)})}(e);return`@font-face {\n        font-family: "${t.fontFamily}";\n        font-weight: ${t.fontWeight};\n        font-style: ${t.fontStyle};\n        src: url('${s}');\n    }`}const dr=new Map;class ur{constructor(t){this._activeTextures={},this._renderer=t,this._createCanvas=t.type===R.WEBGPU}getTexture(t){return this.getTexturePromise(t)}getManagedTexture(t){const e=t.styleKey;if(this._activeTextures[e])return this._increaseReferenceCount(e),this._activeTextures[e].promise;const s=this._buildTexturePromise(t).then(t=>(this._activeTextures[e].texture=t,t));return this._activeTextures[e]={texture:null,promise:s,usageCount:1},s}getReferenceCount(t){return this._activeTextures[t]?.usageCount??null}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}decreaseReferenceCount(t){const e=this._activeTextures[t];e&&(e.usageCount--,0===e.usageCount&&(e.texture?this._cleanUp(e.texture):e.promise.then(t=>{e.texture=t,this._cleanUp(e.texture)}).catch(()=>{jt()}),this._activeTextures[t]=null))}getTexturePromise(t){return this._buildTexturePromise(t)}async _buildTexturePromise(t){const{text:e,style:s,resolution:i,textureStyle:n}=t,r=Vt.get(wn),a=function(t,e){const s=e.fontFamily,i=[],n={},r=t.match(/font-family:([^;"\s]+)/g);function a(t){n[t]||(i.push(t),n[t]=!0)}if(Array.isArray(s))for(let o=0;o<s.length;o++)a(s[o]);else a(s);r&&r.forEach(t=>{a(t.split(":")[1].trim())});for(const o in e.tagStyles)a(e.tagStyles[o].fontFamily);return i}(e,s),o=await async function(t){const e=t.filter(t=>ue.has(`${t}-and-url`)).map(t=>{if(!dr.has(t)){const{entries:e}=ue.get(`${t}-and-url`),s=[];e.forEach(e=>{const i=e.url,n=e.faces.map(t=>({weight:t.weight,style:t.style}));s.push(...n.map(e=>cr({fontWeight:e.weight,fontStyle:e.style,fontFamily:t},i)))}),dr.set(t,Promise.all(s).then(t=>t.join("\n")))}return dr.get(t)});return(await Promise.all(e)).join("\n")}(a),h=function(t,e,s,i){i||(i=Tn||(Tn=new wn));const{domElement:n,styleElement:r,svgRoot:a}=i;n.innerHTML=`<style>${e.cssStyle};</style><div style='padding:0'>${t}</div>`,n.setAttribute("style","transform-origin: top left; display: inline-block"),s&&(r.textContent=s),document.body.appendChild(a);const o=n.getBoundingClientRect();a.remove();const h=2*e.padding;return{width:o.width-h,height:o.height-h}}(e,s,o,r),l=Math.ceil(Math.ceil(Math.max(1,h.width)+2*s.padding)*i),c=Math.ceil(Math.ceil(Math.max(1,h.height)+2*s.padding)*i),d=r.image;d.width=2+(0|l),d.height=2+(0|c);const u=function(t,e,s,i,n){const{domElement:r,styleElement:a,svgRoot:o}=n;r.innerHTML=`<style>${e.cssStyle}</style><div style='padding:0;'>${t}</div>`,r.setAttribute("style",`transform: scale(${s});transform-origin: top left; display: inline-block`),a.textContent=i;const{width:h,height:l}=n.image;return o.setAttribute("width",h.toString()),o.setAttribute("height",l.toString()),(new XMLSerializer).serializeToString(o)}(e,s,i,o,r);await function(t,e,s){return new Promise(async i=>{s&&await new Promise(t=>setTimeout(t,100)),t.onload=()=>{i()},t.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(e)}`,t.crossOrigin="anonymous"})}(d,u,function(){const{userAgent:t}=ne.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}()&&a.length>0);const p=d;let f;this._createCanvas&&(f=function(t,e){const s=I.getOptimalCanvasAndContext(t.width,t.height,e),{context:i}=s;return i.clearRect(0,0,t.width,t.height),i.drawImage(t,0,0),s}(d,i));const m=lr(f?f.canvas:p,d.width-2,d.height-2,i);return n&&(m.source.style=n),this._createCanvas&&(this._renderer.texture.initSource(m.source),I.returnCanvasAndContext(f)),Vt.return(r),m}returnTexturePromise(t){t.then(t=>{this._cleanUp(t)}).catch(()=>{jt()})}_cleanUp(t){F.returnTexture(t,!0),t.source.resource=null,t.source.uploadMethodId="unknown"}destroy(){this._renderer=null;for(const t in this._activeTextures)this._activeTextures[t]&&this.returnTexturePromise(this._activeTextures[t].promise);this._activeTextures=null}}ur.extension={type:[it.WebGLSystem,it.WebGPUSystem,it.CanvasSystem],name:"htmlText"};class pr extends X{constructor(t){super(),this._renderer=t,t.runners.resolutionChange.add(this)}resolutionChange(){const t=this.renderable;t._autoResolution&&t.onViewUpdate()}destroy(){const{canvasText:t}=this._renderer;t.getReferenceCount(this.currentKey)>0?t.decreaseReferenceCount(this.currentKey):this.texture&&t.returnTexture(this.texture),this._renderer.runners.resolutionChange.remove(this),this._renderer=null}}class fr{constructor(t){this._renderer=t}validateRenderable(t){const e=this._getGpuText(t),s=t.styleKey;return e.currentKey!==s||t._didTextUpdate}addRenderable(t,e){const s=this._getGpuText(t);if(t._didTextUpdate){const e=t._autoResolution?this._renderer.resolution:t.resolution;s.currentKey===t.styleKey&&t.resolution===e||this._updateGpuText(t),t._didTextUpdate=!1,ar(s,t)}this._renderer.renderPipes.batch.addToBatch(s,e)}updateRenderable(t){const e=this._getGpuText(t);e._batcher.updateElement(e)}_updateGpuText(t){const e=this._getGpuText(t);e.texture&&this._renderer.canvasText.decreaseReferenceCount(e.currentKey),t._resolution=t._autoResolution?this._renderer.resolution:t.resolution,e.texture=this._renderer.canvasText.getManagedTexture(t),e.currentKey=t.styleKey}_getGpuText(t){return t._gpuData[this._renderer.uid]||this.initGpuText(t)}initGpuText(t){const e=new pr(this._renderer);return e.currentKey="--",e.renderable=t,e.transform=t.groupTransform,e.bounds={minX:0,maxX:1,minY:0,maxY:0},e.roundPixels=this._renderer._roundPixels|t._roundPixels,t._gpuData[this._renderer.uid]=e,e}destroy(){this._renderer=null}}fr.extension={type:[it.WebGLPipes,it.WebGPUPipes,it.CanvasPipes],name:"text"};class mr{constructor(t){this._activeTextures={},this._renderer=t}getTexture(t,e,s,i){"string"==typeof t&&(Ft(0,"CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),t={text:t,style:s,resolution:e}),t.style instanceof ti||(t.style=new ti(t.style)),t.textureStyle instanceof B||(t.textureStyle=new B(t.textureStyle)),"string"!=typeof t.text&&(t.text=t.text.toString());const{text:n,style:r,textureStyle:a}=t,o=t.resolution??this._renderer.resolution,{frame:h,canvasAndContext:l}=xn.getCanvasAndContext({text:n,style:r,resolution:o}),c=lr(l.canvas,h.width,h.height,o);if(a&&(c.source.style=a),r.trim&&(h.pad(r.padding),c.frame.copyFrom(h),c.frame.scale(1/o),c.updateUvs()),r.filters){const t=this._applyFilters(c,r.filters);return this.returnTexture(c),xn.returnCanvasAndContext(l),t}return this._renderer.texture.initSource(c._source),xn.returnCanvasAndContext(l),c}returnTexture(t){const e=t.source;e.resource=null,e.uploadMethodId="unknown",e.alphaMode="no-premultiply-alpha",F.returnTexture(t,!0)}renderTextToCanvas(){Ft(0,"CanvasTextSystem.renderTextToCanvas: no longer supported, use CanvasTextSystem.getTexture instead")}getManagedTexture(t){t._resolution=t._autoResolution?this._renderer.resolution:t.resolution;const e=t.styleKey;if(this._activeTextures[e])return this._increaseReferenceCount(e),this._activeTextures[e].texture;const s=this.getTexture({text:t.text,style:t.style,resolution:t._resolution,textureStyle:t.textureStyle});return this._activeTextures[e]={texture:s,usageCount:1},s}decreaseReferenceCount(t){const e=this._activeTextures[t];e.usageCount--,0===e.usageCount&&(this.returnTexture(e.texture),this._activeTextures[t]=null)}getReferenceCount(t){return this._activeTextures[t]?.usageCount??0}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}_applyFilters(t,e){const s=this._renderer.renderTarget.renderTarget,i=this._renderer.filter.generateFilteredTexture({texture:t,filters:e});return this._renderer.renderTarget.bind(s,!1),i}destroy(){this._renderer=null;for(const t in this._activeTextures)this._activeTextures[t]&&this.returnTexture(this._activeTextures[t].texture);this._activeTextures=null}}mr.extension={type:[it.WebGLSystem,it.WebGPUSystem,it.CanvasSystem],name:"canvasText"},at.add(ot,ht),at.add(Pe),at.mixin(t,{accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,accessibleType:"button",accessibleText:null,accessiblePointerEvents:"auto",accessibleChildren:!0,_accessibleActive:!1,_accessibleDiv:null,_renderId:-1}),at.add($e),at.add(Ge),at.add(ln),at.mixin(t,cn),at.add(Zi),at.add(Yn),at.add(mr),at.add(fr),at.add(ir),at.add(ur),at.add(or);const gr=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),_r=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{$n as $,js as A,Vt as B,Wt as C,ut as D,it as E,Bn as F,Xs as G,Dt as H,Et as I,Lt as J,Nt as K,ce as L,mt as M,Rt as N,lt as O,pt as P,ue as Q,St as R,Me as S,le as T,Ce as U,is as V,Re as W,Fe as X,as as Y,Wn as Z,st as _,Yt as a,Gn as a0,Ue as a1,kn as a2,Rn as a3,Dn as a4,Ln as a5,En as a6,Un as a7,Sn as a8,jn as a9,Ut as aa,pe as ab,ge as ac,be as ad,xe as ae,re as af,pn as ag,Hn as ah,Vn as ai,Cn as aj,un as ak,ki as al,Ci as am,Wi as an,Xi as ao,Ai as ap,We as aq,qi as ar,dt as b,$t as c,Ft as d,at as e,ne as f,Be as g,ss as h,Zs as i,It as j,Ke as k,Ze as l,qe as m,ts as n,Kt as o,Ds as p,zs as q,Xt as r,Vs as s,In as t,kt as u,Bt as v,jt as w,Ys as x,Ls as y,Us as z};
//# sourceMappingURL=pixi-core-Cm8ucNvR.js.map
